<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.dataobject &mdash; GeneFlow 0.8 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html"><img src="../../_static/geneflow_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">GeneFlow:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../geneflow.html">GeneFlow</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../src.html">DataObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.etl">ETL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.model">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.objects">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.processing">Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.utils">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.visualize">Visualize</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeneFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>src.dataobject</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.dataobject</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">@author: Alba Casillas Rodr√≠guez (albacaro@correo.ugr.es)</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">src.utils</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="kn">from</span> <span class="nn">src.processing</span> <span class="kn">import</span> <span class="n">Task</span>
<span class="kn">import</span> <span class="nn">src.processing</span> <span class="k">as</span> <span class="nn">pro</span>
<span class="kn">from</span> <span class="nn">src.objects</span> <span class="kn">import</span> <span class="n">Workflow</span>


<div class="viewcode-block" id="DataObject"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject">[docs]</a><span class="k">class</span> <span class="nc">DataObject</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation of a data structure</span>
<span class="sd">        to save information used on an experiment. With this, the use</span>
<span class="sd">        of data or its modification will be easier to do</span>

<span class="sd">    :param counts_dframe: That will be the count matrix of the DataObject</span>
<span class="sd">    :type counts_dframe: DataFrame </span>
<span class="sd">    :param obs_: That will be the clinical information associated to count matrix</span>
<span class="sd">        on DataObject</span>
<span class="sd">    :type obs_: DataFrame</span>
<span class="sd">    :param var_: That will be the gene information associated to count matrix</span>
<span class="sd">        on DataObject</span>
<span class="sd">    :type var_: DataFrame</span>
<span class="sd">    :param log: That will contains a flow that save step by step the changes of</span>
<span class="sd">        the DataObject. Useful to replicate an experiment with another information</span>
<span class="sd">    :type log: Workflow</span>
<span class="sd">    :param unsdict: It is a variable used to save extra data with an unclassified distribution</span>
<span class="sd">        on DataObject.</span>
<span class="sd">    :type unsdict: dict</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counts_dframe</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">obs_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">var_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">Workflow</span><span class="p">(),</span> <span class="n">unsdict</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Constructor method</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creating DataObject...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">datas</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;counts&quot;</span><span class="p">:</span> <span class="n">counts_dframe</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">),</span>
            <span class="s2">&quot;dims&quot;</span><span class="p">:</span> <span class="n">counts_dframe</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
            <span class="s2">&quot;vars&quot;</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(),</span>  <span class="c1"># filtering by rows with obs</span>
            <span class="s2">&quot;obs&quot;</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(),</span>  <span class="c1"># but empty at the beginning to create the key</span>
            <span class="s2">&quot;logs&quot;</span><span class="p">:</span> <span class="n">log</span><span class="p">,</span>  <span class="c1"># list of name of preproc</span>
            <span class="s2">&quot;uns&quot;</span><span class="p">:</span> <span class="n">unsdict</span>
        <span class="p">}</span>

        <span class="c1"># If there is information for observations</span>
        <span class="c1"># Number of observations MUST coincide in counts and obs dataframes.</span>
        <span class="c1"># Information that it is only in one of the dataframes will be removed.</span>
        <span class="c1"># Counts CAN have a bigger dimension than obs taking into account duplicated data!!</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs_</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">obs_</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>

                <span class="n">rows_o</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">obs_</span><span class="p">)</span>

                <span class="c1"># Extract a subdf of counts that have the columns of obs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataProjectionSubstring</span><span class="p">(</span>
                    <span class="n">rows_o</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span>

                <span class="c1"># Update its dimension</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

                <span class="n">list_columns_counts</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataColumnames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
                    <span class="n">list_columns_counts</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">obs_</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropDuplicates</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">])</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        TO DO: Obs is a list of different dataframes of metadata (e.g: obs for patient, drug, treatment...)</span>
<span class="sd">        In this case, there cannot be duplicated names of columns (e.g: two &quot;gender&quot; columns for the same observations)</span>
<span class="sd">        </span>
<span class="sd">        elif isinstance(obs_, list):</span>
<span class="sd">            for o in obs_:</span>
<span class="sd">                if isinstance(obs_, ut.pd.DataFrame):</span>
<span class="sd">                    print(o.shape)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># If there is information for variables</span>
        <span class="c1"># Number of variables MUST coincide in counts and vars dataframes.</span>
        <span class="c1"># Information that it is only in one of the dataframes will be removed.</span>
        <span class="c1"># Counts CAN have a bigger dimension than vars taking into account duplicated data!!</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">var_</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">rows_v</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">var_</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

                <span class="c1"># Extract a subdf of counts that have the rows of vars</span>
                <span class="n">select_object</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span><span class="n">rows_v</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_object</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span>

                <span class="c1"># Update its dimension</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

                <span class="n">rows_v</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span><span class="n">rows_v</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">var_</span><span class="p">)</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        TO DO: Obs is a list of different dataframes of metadata</span>
<span class="sd">        In this case, there cannot be duplicated names of columns (e.g: two &quot;gene_names&quot; columns for the same variables)</span>
<span class="sd">        </span>
<span class="sd">        elif isinstance(var_, list):            </span>
<span class="sd">            for v in var_:</span>
<span class="sd">                if isinstance(var_, ut.pd.DataFrame):</span>
<span class="sd">                    print(v.shape)</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="c1">###############################################################################</span>

<span class="c1">#                        GET AND SET FUNCTIONS</span>

<span class="c1">###############################################################################</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GET</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataObject.get_datas"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_datas">[docs]</a>    <span class="k">def</span> <span class="nf">get_datas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all information about DataObject</span>

<span class="sd">        :return: a dictionary with information read</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span></div>

<div class="viewcode-block" id="DataObject.get_counts"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_counts">[docs]</a>    <span class="k">def</span> <span class="nf">get_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the count matrix of the DataObject</span>

<span class="sd">        :return: Count Matrix of the DataObject</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataObject.get_counts_dims"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_counts_dims">[docs]</a>    <span class="k">def</span> <span class="nf">get_counts_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the dimensions of Count Matrix</span>

<span class="sd">        :return: a tuple with dimensions of Count Matrix</span>
<span class="sd">        :rtype: tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataObject.get_obs"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_obs">[docs]</a>    <span class="k">def</span> <span class="nf">get_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the clinical information of DataObject</span>

<span class="sd">        :return: a DataFrame with clinical information</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataObject.get_obs_dims"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_obs_dims">[docs]</a>    <span class="k">def</span> <span class="nf">get_obs_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the dimensions of clinical information</span>

<span class="sd">        :return: a tuple with dimensions of clinical information</span>
<span class="sd">        :rtype: tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span></div>

<div class="viewcode-block" id="DataObject.get_vars"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_vars">[docs]</a>    <span class="k">def</span> <span class="nf">get_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the gene information of DataObject</span>

<span class="sd">        :return: a DataFrame with gene information</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataObject.get_vars_dims"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_vars_dims">[docs]</a>    <span class="k">def</span> <span class="nf">get_vars_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the dimensions of gene information</span>

<span class="sd">        :return: a tuple with dimensions of gene information</span>
<span class="sd">        :rtype: tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span></div>

<div class="viewcode-block" id="DataObject.get_workflow"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_workflow">[docs]</a>    <span class="k">def</span> <span class="nf">get_workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the flow of the DataObject</span>

<span class="sd">        :return: a Workflow object type that contains information </span>
<span class="sd">            about the changes of DataObject</span>
<span class="sd">        :rtype: Workflow</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;logs&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataObject.len_log"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.len_log">[docs]</a>    <span class="k">def</span> <span class="nf">len_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns how many step have done</span>

<span class="sd">        :return: number of the step done</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;logs&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="DataObject.get_uns"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.get_uns">[docs]</a>    <span class="k">def</span> <span class="nf">get_uns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an unstructured data of the DataObject</span>

<span class="sd">        :return: a dictionary with unclassified information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;uns&quot;</span><span class="p">]</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SET</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If the dimensions of counts change, it is needed to modify the affected metadata</span>
    <span class="c1"># to make both datasets have the SAME variables / observations.</span>
    <span class="c1"># E.g: If a observation is removed from counts, the same observation must be removed</span>
    <span class="c1"># for the observation&#39;s metadata.</span>
<div class="viewcode-block" id="DataObject.set_counts"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.set_counts">[docs]</a>    <span class="k">def</span> <span class="nf">set_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counts</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Count Matrix to new one.</span>
<span class="sd">            Control that the rest of the data match with new Count Matrix</span>

<span class="sd">        :param counts: new Count Matrix</span>
<span class="sd">        :type counts: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts</span>

        <span class="c1"># To avoid errors, dim of Counts dataframe is updated</span>
        <span class="c1"># only if count_data is updated</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">shape</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_obs</span><span class="p">(),</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obs</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>

                <span class="n">list_columns_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_columnames</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
                    <span class="n">list_columns_obs</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">])</span>

                <span class="c1"># Remove duplicates because observations cannot have duplicated data</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropDuplicates</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">])</span>

                <span class="c1"># Update counts</span>
                <span class="n">rows_o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_rownames</span><span class="p">()</span>

                <span class="c1"># Make sure counts doesn&#39;t have information that there isn&#39;t in observations</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataProjectionSubstring</span><span class="p">(</span>
                    <span class="n">rows_o</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_vars</span><span class="p">(),</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vars</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>

                <span class="n">rows_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_rownames</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
                    <span class="n">rows_v</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">])</span>

                <span class="c1"># Remove duplicates</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropDuplicates</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">])</span>

                <span class="c1"># Update counts</span>
                <span class="n">rows_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_rownames</span><span class="p">()</span>

                <span class="c1"># Make sure counts doesn&#39;t have information that there isn&#39;t in variables</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
                    <span class="n">rows_v</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span></div>

<div class="viewcode-block" id="DataObject.update_counts"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.update_counts">[docs]</a>    <span class="k">def</span> <span class="nf">update_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counts</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Count Matrix to new one.</span>
<span class="sd">            It only modifies values inside matrix, neither columns or rows</span>

<span class="sd">        :param counts: new values of Count Matrix</span>
<span class="sd">        :type counts: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts</span></div>

    <span class="c1"># When obs it is updated, it is needed to update counts information to match between observations</span>

<div class="viewcode-block" id="DataObject.set_obs"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.set_obs">[docs]</a>    <span class="k">def</span> <span class="nf">set_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s clinical information to new one.</span>
<span class="sd">            Control that the rest of the data match with new clinical information</span>

<span class="sd">        :param obs_: new clinical information</span>
<span class="sd">        :type obs_: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs_</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="n">rows_o</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">obs_</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataProjectionSubstring</span><span class="p">(</span>
                <span class="n">rows_o</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

            <span class="n">list_columns_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_columnames</span><span class="p">()</span>

            <span class="c1"># updated obs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
                <span class="n">list_columns_obs</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">obs_</span><span class="p">)</span>

            <span class="c1"># Remove duplicates</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropDuplicates</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">])</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs_</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs_</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs_</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Obs passed is not correct</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ut</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

    <span class="c1"># When obs it is updated, it is needed to update counts information to match between observations</span>

<div class="viewcode-block" id="DataObject.set_var"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.set_var">[docs]</a>    <span class="k">def</span> <span class="nf">set_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s gene information to new one.</span>
<span class="sd">            Control that the rest of the data match with new gene information</span>

<span class="sd">        :param var_: new gene information</span>
<span class="sd">        :type var_: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="n">rows_v</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">var_</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
                <span class="n">rows_v</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

            <span class="n">rows_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_rownames</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span><span class="n">rows_v</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">var_</span><span class="p">)</span>

            <span class="c1"># Remove duplicates</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropDuplicates</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">])</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var_</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Vars passed is not correct</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ut</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataObject.set_log"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.set_log">[docs]</a>    <span class="k">def</span> <span class="nf">set_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loglist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Log to new one.</span>

<span class="sd">        :param loglist: new workflow</span>
<span class="sd">        :type loglist: Workflow</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;logs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loglist</span></div>

<div class="viewcode-block" id="DataObject.set_uns_data"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.set_uns_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_uns_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unsdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s unstructured data to new one.</span>

<span class="sd">        :param unsdict: new unstructured data</span>
<span class="sd">        :type unsdict: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;uns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unsdict</span></div>


<span class="c1">###############################################################################</span>

<span class="c1">#                             BASIC GET</span>

<span class="c1">###############################################################################</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    COUNTS</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataObject.counts_index_name"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.counts_index_name">[docs]</a>    <span class="k">def</span> <span class="nf">counts_index_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the index name of Count Matrix</span>

<span class="sd">        :return: the name of the index of Count Matrix</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span></div>

<div class="viewcode-block" id="DataObject.counts_columnames"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.counts_columnames">[docs]</a>    <span class="k">def</span> <span class="nf">counts_columnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the column names of Count Matrix</span>

<span class="sd">        :return: a list with column names of Count Matrix</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataObject.counts_num_columns"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.counts_num_columns">[docs]</a>    <span class="k">def</span> <span class="nf">counts_num_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns how many columns have Count Matrix</span>

<span class="sd">        :return: number of columns of Count Matrix</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataObject.counts_rownames"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.counts_rownames">[docs]</a>    <span class="k">def</span> <span class="nf">counts_rownames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the row names of Count Matrix</span>

<span class="sd">        :return: a list with row names of Count Matrix</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataObject.counts_num_rows"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.counts_num_rows">[docs]</a>    <span class="k">def</span> <span class="nf">counts_num_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns how many rows have Count Matrix</span>

<span class="sd">        :return: number of rows of Count Matrix</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    OBS</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataObject.obs_index_name"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.obs_index_name">[docs]</a>    <span class="k">def</span> <span class="nf">obs_index_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the index name of clinical information</span>

<span class="sd">        :return: the name of the index of clinical information</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span></div>

<div class="viewcode-block" id="DataObject.obs_columnames"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.obs_columnames">[docs]</a>    <span class="k">def</span> <span class="nf">obs_columnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the column names of clinical information</span>

<span class="sd">        :return: a list with column names of clinical information</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataObject.obs_num_columns"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.obs_num_columns">[docs]</a>    <span class="k">def</span> <span class="nf">obs_num_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns how many columns have clinical information</span>

<span class="sd">        :return: number of columns of clinical information</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataObject.obs_rownames"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.obs_rownames">[docs]</a>    <span class="k">def</span> <span class="nf">obs_rownames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the row names of clinical information</span>

<span class="sd">        :return: a list with row names of clinical information</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataObject.obs_num_rows"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.obs_num_rows">[docs]</a>    <span class="k">def</span> <span class="nf">obs_num_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns how many rows have clinical information</span>

<span class="sd">        :return: number of rows of clinical information</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    VAR</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataObject.var_index_name"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.var_index_name">[docs]</a>    <span class="k">def</span> <span class="nf">var_index_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the index name of gene information</span>

<span class="sd">        :return: the name of the index of gene information</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span></div>

<div class="viewcode-block" id="DataObject.var_columnames"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.var_columnames">[docs]</a>    <span class="k">def</span> <span class="nf">var_columnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the column names of gene information</span>

<span class="sd">        :return: a list with column names of gene information</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataObject.var_num_columns"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.var_num_columns">[docs]</a>    <span class="k">def</span> <span class="nf">var_num_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns how many columns have gene information</span>

<span class="sd">        :return: number of columns of gene information</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataObject.var_rownames"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.var_rownames">[docs]</a>    <span class="k">def</span> <span class="nf">var_rownames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the row names of gene information</span>

<span class="sd">        :return: a list with row names of gene information</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataObject.var_num_rows"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.var_num_rows">[docs]</a>    <span class="k">def</span> <span class="nf">var_num_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns how many row have gene information</span>

<span class="sd">        :return: number of row of gene information</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<span class="c1">###############################################################################</span>

<span class="c1">#                             STR - SUMMARY</span>

<span class="c1">###############################################################################</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;str method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summ</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">##############################################&quot;</span><span class="p">)</span>
        <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Object&quot;</span><span class="p">)</span>
        <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Dimensions: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_counts_dims</span><span class="p">()))</span>

        <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Row Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_num_rows</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">counts_rownames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_rownames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Column Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_num_columns</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">counts_columnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_columnames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Var&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">There is no data for Vars&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Dimensions: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_vars_dims</span><span class="p">()))</span>

            <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Row Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_num_rows</span><span class="p">(),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">var_rownames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_rownames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Column Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">var_num_columns</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_columnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_columnames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># RowData Names is ColumnsName of Vars</span>

        <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">Obs&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">There is no data for observations&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Dimensions: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_vars_dims</span><span class="p">()))</span>

            <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Row Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_num_rows</span><span class="p">(),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">obs_rownames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_rownames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Column Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obs_num_columns</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_columnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_columnames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># ColData Names is ColumnsName of Obs</span>
        <span class="n">summ</span> <span class="o">=</span> <span class="n">summ</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">##############################################&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">summ</span>

<div class="viewcode-block" id="DataObject.summary_object"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObject.summary_object">[docs]</a>    <span class="k">def</span> <span class="nf">summary_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Represent a summary of the DataObject on output</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">##############################################&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Object&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Dimensions: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_counts_dims</span><span class="p">())</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Row Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_num_rows</span><span class="p">(),</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">counts_rownames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_rownames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Column Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_num_columns</span><span class="p">(</span>
        <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_columnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_columnames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">Var&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">There is no data for Vars&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Dimensions: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vars_dims</span><span class="p">())</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Row Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">var_num_rows</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_rownames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_rownames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Column Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">var_num_columns</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_columnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_columnames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># RowData Names is ColumnsName of Vars</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">Obs&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">There is no data for observations&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Dimensions: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obs_dims</span><span class="p">())</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Row Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obs_num_rows</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_rownames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_rownames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Column Names (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2"> ... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obs_num_columns</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_columnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_columnames</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># ColData Names is ColumnsName of Obs</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">##############################################&quot;</span><span class="p">)</span></div></div>


<span class="c1">###############################################################################</span>

<span class="c1">#                             EQ - EQUALITY</span>

<span class="c1">###############################################################################</span>

<span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DataObject</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()):</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">get_counts_dims</span><span class="p">():</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">get_vars</span><span class="p">()):</span>

                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">get_obs</span><span class="p">()):</span>

                                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datas</span><span class="p">[</span><span class="s2">&quot;uns&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">get_uns</span><span class="p">():</span>

                                    <span class="k">return</span> <span class="kc">True</span>

            <span class="k">return</span> <span class="kc">False</span>



<span class="c1">###############################################################################</span>

<span class="c1">#                     FUNCTIONS TO WORK WITH THE DATA</span>

<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="DataObjectTask"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectTask">[docs]</a><span class="k">class</span> <span class="nc">DataObjectTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with DataObject as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="DataObjectTask.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectTask.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">parameters</span></div></div>


<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">COUNTS</span>

<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="DataObjectCounts"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectCounts">[docs]</a><span class="k">class</span> <span class="nc">DataObjectCounts</span><span class="p">(</span><span class="n">DataObjectTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with Count Matrix of DataObject as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="DataObjectCounts.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectCounts.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataObjectCounts.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectCounts.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div></div>


<span class="c1"># =============================================================================</span>
<span class="c1">#                        BASIC FUNCTIONS FOR COUNTS</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="SetCounts"><a class="viewcode-back" href="../../src.html#src.dataobject.SetCounts">[docs]</a><span class="k">class</span> <span class="nc">SetCounts</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Count Matrix to new one.</span>
<span class="sd">        Control that the rest of the data match with new Count Matrix</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param new_counts: new Count Matrix</span>
<span class="sd">    :type new_counts: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_counts</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span> <span class="o">=</span> <span class="n">new_counts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="SetCounts.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.SetCounts.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_counts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="SetCounts.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.SetCounts.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_counts&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="n">nm</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">nm</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_name&#39;</span><span class="p">]})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_name&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="SetCounts.get_new_counts"><a class="viewcode-back" href="../../src.html#src.dataobject.SetCounts.get_new_counts">[docs]</a>    <span class="k">def</span> <span class="nf">get_new_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new count matrix</span>

<span class="sd">        :return: a dataframe with the new count matrix</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span></div>

<div class="viewcode-block" id="SetCounts.new_counts_to_json"><a class="viewcode-back" href="../../src.html#src.dataobject.SetCounts.new_counts_to_json">[docs]</a>    <span class="k">def</span> <span class="nf">new_counts_to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transform a DataFrame to JSON format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.new_counts = self.new_counts.to_json()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></div>

<div class="viewcode-block" id="SetCounts.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.SetCounts.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;new_counts&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new content for count matrix of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to change its count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;the same DataObject with count matrix changed&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="SetCounts.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.SetCounts.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="SetCounts.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.SetCounts.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">aux_self</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">aux_self</span><span class="o">.</span><span class="n">new_counts_to_json</span><span class="p">()</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="n">aux_self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Set&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Set method of the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_new_counts</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="UpdateCounts"><a class="viewcode-back" href="../../src.html#src.dataobject.UpdateCounts">[docs]</a><span class="k">class</span> <span class="nc">UpdateCounts</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Count Matrix to new one but only modify its values.</span>
<span class="sd">        In this case, the function not control that the rest of the data match with new Count Matrix</span>
<span class="sd">        because any row or column will be modify. Will have the same shape</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param new_counts: new Count Matrix</span>
<span class="sd">    :type new_counts: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_counts</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span> <span class="o">=</span> <span class="n">new_counts</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="UpdateCounts.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.UpdateCounts.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_counts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="UpdateCounts.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.UpdateCounts.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_counts&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="UpdateCounts.get_new_counts"><a class="viewcode-back" href="../../src.html#src.dataobject.UpdateCounts.get_new_counts">[docs]</a>    <span class="k">def</span> <span class="nf">get_new_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new count matrix</span>

<span class="sd">        :return: a dataframe with the new count matrix</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_counts</span></div>

<div class="viewcode-block" id="UpdateCounts.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.UpdateCounts.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;new_counts&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new values for count matrix of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to change its values of matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;the same DataObject with count matrix changed without modify Vars and Obs&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="UpdateCounts.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.UpdateCounts.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="UpdateCounts.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.UpdateCounts.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_new_counts</span><span class="p">(),</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Update Values&quot;</span><span class="p">,</span>
                                             <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Update the values of the Counts DataFrame.&quot;</span><span class="p">)</span>

            <span class="n">dobj</span><span class="o">.</span><span class="n">update_counts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_new_counts</span><span class="p">())</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data must be a DataFrame&quot;</span><span class="p">)</span>
            <span class="n">ut</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<span class="c1"># =============================================================================</span>
<span class="c1">#                       ACCESSING COUNTS DATAFRAME</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="CountsSelection"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsSelection">[docs]</a><span class="k">class</span> <span class="nc">CountsSelection</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Count Matrix selecting a specific row list.</span>
<span class="sd">        Control that the rest of the data match with new Count Matrix</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param row_list: A list with the names of the rows to keep</span>
<span class="sd">    :type row_list: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_list</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span> <span class="o">=</span> <span class="n">row_list</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsSelection.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsSelection.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;row_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsSelection.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsSelection.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;row_list&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsSelection.get_row_list"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsSelection.get_row_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_row_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the row names to keep</span>

<span class="sd">        :return: a list with row names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span></div>

<div class="viewcode-block" id="CountsSelection.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsSelection.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;row_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;list of rows name to select the count matrix of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to select specific rows of count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject selected by list on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsSelection.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsSelection.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsSelection.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsSelection.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Selection&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Extract a sub-DataFrame using a list of rows over the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">extractor</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_row_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="n">extractor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="CountsProjection"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjection">[docs]</a><span class="k">class</span> <span class="nc">CountsProjection</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>  <span class="c1"># Columns</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Count Matrix selecting a specific column list.</span>
<span class="sd">        Control that the rest of the data match with new Count Matrix</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param col_list: A list with the names of the columns to keep</span>
<span class="sd">    :type col_list: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_list</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span> <span class="o">=</span> <span class="n">col_list</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsProjection.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjection.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsProjection.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjection.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_list&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsProjection.get_col_list"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjection.get_col_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the column names to keep</span>

<span class="sd">        :return: a list with column names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span></div>

<div class="viewcode-block" id="CountsProjection.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjection.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;col_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;list of columns name to project the DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to project specific columns of count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject projected by list on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsProjection.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjection.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsProjection.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjection.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Projection&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Extract a sub-DataFrame using a list of columns over the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">extractor</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataProjectionList</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_col_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="n">extractor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="CountsProjectionSubstring"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjectionSubstring">[docs]</a><span class="k">class</span> <span class="nc">CountsProjectionSubstring</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Count Matrix selecting a specific column list.</span>
<span class="sd">        In that case, is not neccesary that name of the column were exactly</span>
<span class="sd">        Control that the rest of the data match with new Count Matrix</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param col_list: A list with the names of the columns to keep</span>
<span class="sd">    :type col_list: list</span>
<span class="sd">    :param rename: True if the column names of Count Matrix need to be renamed, False otherwise</span>
<span class="sd">    :type rename: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">rename</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span> <span class="o">=</span> <span class="n">col_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename</span> <span class="o">=</span> <span class="n">rename</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsProjectionSubstring.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjectionSubstring.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;rename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsProjectionSubstring.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjectionSubstring.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_list&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;rename&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsProjectionSubstring.get_col_list"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjectionSubstring.get_col_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the column names to keep</span>

<span class="sd">        :return: a list with column names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span></div>

<div class="viewcode-block" id="CountsProjectionSubstring.get_rename"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjectionSubstring.get_rename">[docs]</a>    <span class="k">def</span> <span class="nf">get_rename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns option selected to rename or not column name of Count Matrix</span>

<span class="sd">        :return: True if need to rename, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rename</span></div>

<div class="viewcode-block" id="CountsProjectionSubstring.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjectionSubstring.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;col_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;list of columns name to project the DataObject. No need to be the exact name&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;rename&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;True if the column name of count matrix will be renamed to partial name of col_list, False otherwise&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to project specific columns of count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject projected by list on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsProjectionSubstring.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjectionSubstring.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsProjectionSubstring.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsProjectionSubstring.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Projection + Substring&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Extract a sub-DataFrame using a list of column name&#39;s substrings over the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">extractor</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataProjectionSubstring</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_col_list</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rename</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="n">extractor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<span class="c1"># replace nan by mean</span>
<div class="viewcode-block" id="CountsReplaceNan"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplaceNan">[docs]</a><span class="k">class</span> <span class="nc">CountsReplaceNan</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace nan values to mean of the row of Count Matrix</span>
<span class="sd">        Only modifies values of Count Matrix.</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsReplaceNan.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplaceNan.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsReplaceNan.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplaceNan.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsReplaceNan.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplaceNan.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to replace nan values to mean on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with nan of count matrix replaced by mean&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsReplaceNan.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplaceNan.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsReplaceNan.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplaceNan.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Replace Nans by Mean&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Replace all NaN values from the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">data_tmp</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">FillNan</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">update_counts</span><span class="p">(</span><span class="n">data_tmp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="CountsDropDuplicates"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates">[docs]</a><span class="k">class</span> <span class="nc">CountsDropDuplicates</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop DataObject&#39;s Count Matrix duplicates.</span>
<span class="sd">        Control that the rest of the data match with new Count Matrix</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param axis: axis 0 means by rows, 1 by columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param keep: Indicates which duplicates will keep on Count Matrix.</span>
<span class="sd">        \&quot;first\&quot; keeps only the first duplicated column/row; \&quot;last\&quot; keeps only the last duplicated column/row; False keeps both duplicated columns/rows</span>
<span class="sd">    :type keep: str, bool</span>
<span class="sd">    :param by_name: True if only evaluate the name of the column/row, False if evaluate the content of the column/row to decide if is duplicated or not</span>
<span class="sd">    :type by_name: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>  <span class="c1"># axis 0 rows, 1 columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span>  <span class="c1"># False delete both duplicates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span> <span class="o">=</span> <span class="n">by_name</span>  <span class="c1"># if True, only take into account duplicates by column/row names</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsDropDuplicates.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsDropDuplicates.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsDropDuplicates.get_axis"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to drop duplicates</span>

<span class="sd">        :return: a number that could be 0 by rows and 1 by columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>

<div class="viewcode-block" id="CountsDropDuplicates.get_keep"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates.get_keep">[docs]</a>    <span class="k">def</span> <span class="nf">get_keep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which duplicates will keep on Count Matrix</span>

<span class="sd">        :return: could be &quot;\&quot;first\&quot;, \&quot;last\&quot; or False</span>
<span class="sd">        :rtype: str, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span></div>

<div class="viewcode-block" id="CountsDropDuplicates.get_by_name"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates.get_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which kind of evaluation will do to know if a row or column is duplicate or not</span>

<span class="sd">        :return: True if only search by row or column name, False if analyze value of row or column</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span></div>

<div class="viewcode-block" id="CountsDropDuplicates.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;indicated 0 to row or 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;keep&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">first</span><span class="se">\&quot;</span><span class="s2"> keeps only the first duplicated column/row; </span><span class="se">\&quot;</span><span class="s2">last</span><span class="se">\&quot;</span><span class="s2"> keeps only the last duplicated column/row; False keeps both duplicated columns/rows&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;by_name&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;True if only evaluate the name of the column/row, False if evaluate the content of the column/row to decide if is duplicated or not&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to drop duplicates on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject without duplicates rows or columns on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsDropDuplicates.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsDropDuplicates.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropDuplicates.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Drop Duplicates&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Remove the duplicates from the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">drop</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropDuplicates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">(</span>
        <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="n">drop</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="CountsDropValues"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues">[docs]</a><span class="k">class</span> <span class="nc">CountsDropValues</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop DataObject&#39;s Count Matrix values.</span>
<span class="sd">        Control that the rest of the data match with new Count Matrix</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param to_delete: value to be delete.</span>
<span class="sd">    :type to_delete: str, float, int, bool, list, ndarray, </span>
<span class="sd">    :param axis: Indicates 0 to row and 1 to columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param method: all to check all values are the same, any if a partial value match</span>
<span class="sd">    :type method: str</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">=</span> <span class="n">to_delete</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsDropValues.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_delete&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsDropValues.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_delete&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsDropValues.get_to_delete"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues.get_to_delete">[docs]</a>    <span class="k">def</span> <span class="nf">get_to_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value to be delete</span>

<span class="sd">        :return: value to be delete</span>
<span class="sd">        :rtype: str, float, int, bool, list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span></div>

<div class="viewcode-block" id="CountsDropValues.get_axis"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to search value</span>

<span class="sd">        :return: 0 to row and 1 to columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>

<div class="viewcode-block" id="CountsDropValues.get_method"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues.get_method">[docs]</a>    <span class="k">def</span> <span class="nf">get_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the method to check if value should be delete</span>

<span class="sd">        :return: all to check all values are the same, any if a partial value match</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span></div>

<div class="viewcode-block" id="CountsDropValues.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;to_delete&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;value to be delete&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Indicates 0 to row and 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;all to check all values are the same, any if a partial value match&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to drop values on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject without that values on rows or columns on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsDropValues.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsDropValues.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropValues.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Drop Values&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Remove the value(s) in the rows/columns from the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">dropn</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropValues</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_delete</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span>
        <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_method</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="n">dropn</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="CountsDropNanByThresh"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropNanByThresh">[docs]</a><span class="k">class</span> <span class="nc">CountsDropNanByThresh</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop DataObject&#39;s Count Matrix values limited by Threshold.</span>
<span class="sd">        Control that the rest of the data match with new Count Matrix</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param axis: Indicates 0 to row and 1 to columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param thresh: threshold to evaluate element. If value less than threshold, that will be selected to drop</span>
<span class="sd">    :type thresh: float, int</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">thresh</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsDropNanByThresh.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropNanByThresh.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsDropNanByThresh.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropNanByThresh.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thresh&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsDropNanByThresh.get_axis"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropNanByThresh.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to search value</span>

<span class="sd">        :return: 0 to row and 1 to columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>

<div class="viewcode-block" id="CountsDropNanByThresh.get_thresh"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropNanByThresh.get_thresh">[docs]</a>    <span class="k">def</span> <span class="nf">get_thresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the threshold to evaluate element</span>

<span class="sd">        :return: If value less than it, that will be selected to drop</span>
<span class="sd">        :rtype: float, int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span></div>

<div class="viewcode-block" id="CountsDropNanByThresh.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropNanByThresh.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;indicates 0 to rows or 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;thresh&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;threshold to evaluate element. If value less than threshold, that will be selected to drop&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to drop values&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with drop element checking a threshold&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsDropNanByThresh.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropNanByThresh.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsDropNanByThresh.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsDropNanByThresh.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Drop Nan values&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Replace value(s) of the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">dropthresh</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropNanByThresh</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="n">dropthresh</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="CountsReplace"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplace">[docs]</a><span class="k">class</span> <span class="nc">CountsReplace</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace DataObject&#39;s Count Matrix values with another.</span>
<span class="sd">        Control that the rest of the data match with new Count Matrix</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param to_replace: values to be replaced</span>
<span class="sd">    :type to_replace: str, float, int, bool, list, ndarray</span>
<span class="sd">    :param replaced_by: new value to replaced the value before</span>
<span class="sd">    :type replaced_by: str, float, int, bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_replace</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span> <span class="n">replaced_by</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span> <span class="o">=</span> <span class="n">to_replace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span> <span class="o">=</span> <span class="n">replaced_by</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsReplace.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplace.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_replace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;replaced_by&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsReplace.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplace.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_replace&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;replaced_by&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsReplace.get_to_replace"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplace.get_to_replace">[docs]</a>    <span class="k">def</span> <span class="nf">get_to_replace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value to search to replace</span>

<span class="sd">        :return: a value to be replace</span>
<span class="sd">        :rtype: str, float, int, bool, list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span></div>

<div class="viewcode-block" id="CountsReplace.get_replaced_by"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplace.get_replaced_by">[docs]</a>    <span class="k">def</span> <span class="nf">get_replaced_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new value</span>

<span class="sd">        :return: a value replace</span>
<span class="sd">        :rtype: str, float, int, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span></div>

<div class="viewcode-block" id="CountsReplace.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplace.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;to_replace&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;values to be replaced&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;replaced_by&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new value to replaced the value before&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to replace values&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with replaced values&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsReplace.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplace.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsReplace.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsReplace.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Replace Values&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Replace value(s) of the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">replace</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_replace</span><span class="p">(),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">get_replaced_by</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="n">replace</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="CountsTranspose"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsTranspose">[docs]</a><span class="k">class</span> <span class="nc">CountsTranspose</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Do transpose to DataObject&#39;s Count Matrix</span>
<span class="sd">            Control that the rest of the data match with new Count Matrix</span>
<span class="sd">            This class is a Task which allows generate a Workflow</span>
<span class="sd">            When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">        :param index_name: the name of the index before transpose to keep it</span>
<span class="sd">        :type index_name: str, int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span> <span class="o">=</span> <span class="n">index_name</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsTranspose.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsTranspose.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsTranspose.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsTranspose.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsTranspose.get_index_name"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsTranspose.get_index_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_index_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the current index name before transpose</span>

<span class="sd">        :return: name of the current index</span>
<span class="sd">        :rtype: str, int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span></div>

<div class="viewcode-block" id="CountsTranspose.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsTranspose.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;index_name&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;name of the index if exists&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to do a transpose on count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with transpose count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsTranspose.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsTranspose.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsTranspose.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsTranspose.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - Transpose&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Calculates the transpose of the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">transpose</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">Transpose</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_index_name</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_counts</span><span class="p">(</span><span class="n">transpose</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="CountsCPM"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsCPM">[docs]</a><span class="k">class</span> <span class="nc">CountsCPM</span><span class="p">(</span><span class="n">DataObjectCounts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Normalize DataObject&#39;s Count Matrix using CPM method</span>
<span class="sd">        It is not neccesary to control that the rest of the data match with new Count Matrix.</span>
<span class="sd">        It only modify values inside Count Matrix.</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param log_method: True if CPM will do with logaritmic alghoritm, False otherwise</span>
<span class="sd">    :type log_method: bool</span>
<span class="sd">    :param prior_count: If log is True, ends up getting scaled by the ratio of a library size to the average library size and then multiplied by its value before getting added to each library size</span>
<span class="sd">    :type prior_count: int</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_method</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prior_count</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_method</span> <span class="o">=</span> <span class="n">log_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prior_count</span> <span class="o">=</span> <span class="n">prior_count</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountsCPM.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsCPM.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;log_method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_method</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;prior_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prior_count</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountsCPM.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsCPM.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_method</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;log_method&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prior_count</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;prior_count&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountsCPM.get_log_method"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsCPM.get_log_method">[docs]</a>    <span class="k">def</span> <span class="nf">get_log_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns if CPM will be apply with logaritmic or not</span>

<span class="sd">        :return: True if CPM will do with logaritmic alghoritm, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_method</span></div>

<div class="viewcode-block" id="CountsCPM.get_prior_count"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsCPM.get_prior_count">[docs]</a>    <span class="k">def</span> <span class="nf">get_prior_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the ratio of a library size to the average library size</span>

<span class="sd">        :return: the ratio of a library size to the average library size</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prior_count</span></div>

<div class="viewcode-block" id="CountsCPM.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsCPM.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;log_method&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;True if CPM will do with logaritmic alghoritm, False otherwise&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;prior_count&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;If log is True, ends up getting scaled by the ratio of a library size to the average library size and then multiplied by its value before getting added to each library size&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to normalize its count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with normalized count matrix by one of two options&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="CountsCPM.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsCPM.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CountsCPM.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.CountsCPM.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Counts - CPM&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Operates a Count-per-Million (CPM) normalization over the Counts DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">norm_cpm</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">CPM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_log_method</span><span class="p">(),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">get_prior_count</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">update_counts</span><span class="p">(</span><span class="n">norm_cpm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">OBSERVATIONS</span>

<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="DataObjectObs"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectObs">[docs]</a><span class="k">class</span> <span class="nc">DataObjectObs</span><span class="p">(</span><span class="n">DataObjectTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with Observation (Clinical Information) of DataObject as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="DataObjectObs.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectObs.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataObjectObs.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectObs.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SetObs"><a class="viewcode-back" href="../../src.html#src.dataobject.SetObs">[docs]</a><span class="k">class</span> <span class="nc">SetObs</span><span class="p">(</span><span class="n">DataObjectObs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Clinical Information to new one.</span>
<span class="sd">        Control that the rest of the data match with new Observations</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param new_obs: new Clinical Information</span>
<span class="sd">    :type new_obs: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_obs</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_obs</span> <span class="o">=</span> <span class="n">new_obs</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="SetObs.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.SetObs.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_obs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_obs</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="SetObs.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.SetObs.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_obs</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_obs&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="SetObs.get_new_obs"><a class="viewcode-back" href="../../src.html#src.dataobject.SetObs.get_new_obs">[docs]</a>    <span class="k">def</span> <span class="nf">get_new_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new observations</span>

<span class="sd">        :return: a dataframe with the new clinical information</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_obs</span></div>

<div class="viewcode-block" id="SetObs.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.SetObs.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;new_obs&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new content for obs of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to change its obs&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;the same DataObject with obs changed&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="SetObs.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.SetObs.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="SetObs.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.SetObs.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Obs - Set&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Set method of the Obs DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_obs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_new_obs</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<span class="c1"># =============================================================================</span>
<span class="c1">#                           ACCESSING OBS DATAFRAME</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="ObsSelection"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsSelection">[docs]</a><span class="k">class</span> <span class="nc">ObsSelection</span><span class="p">(</span><span class="n">DataObjectObs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Observations selecting a specific row list.</span>
<span class="sd">        Control that the rest of the data match with new Observations</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param row_list: A list with the names of the rows to keep</span>
<span class="sd">    :type row_list: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_list</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span> <span class="o">=</span> <span class="n">row_list</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="ObsSelection.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsSelection.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;row_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="ObsSelection.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsSelection.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;row_list&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="ObsSelection.get_row_list"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsSelection.get_row_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_row_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the row names to keep</span>

<span class="sd">        :return: a list with row names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span></div>

<div class="viewcode-block" id="ObsSelection.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsSelection.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;row_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;list of rows name to select the obs of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to select specific rows of obs&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject selected by list on obs&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="ObsSelection.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsSelection.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="ObsSelection.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsSelection.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Obs - Selection&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Extract a sub-DataFrame using a list of rows over the Obs DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">extractor</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_row_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_obs</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_obs</span><span class="p">(</span><span class="n">extractor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="ObsProjection"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsProjection">[docs]</a><span class="k">class</span> <span class="nc">ObsProjection</span><span class="p">(</span><span class="n">DataObjectObs</span><span class="p">):</span>  <span class="c1"># Columns</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Observations selecting a specific column list.</span>
<span class="sd">        Control that the rest of the data match with new Observations</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param col_list: A list with the names of the columns to keep</span>
<span class="sd">    :type col_list: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_list</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span> <span class="o">=</span> <span class="n">col_list</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="ObsProjection.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsProjection.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="ObsProjection.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsProjection.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_list&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="ObsProjection.get_col_list"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsProjection.get_col_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the column names to keep</span>

<span class="sd">        :return: a list with column names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span></div>

<div class="viewcode-block" id="ObsProjection.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsProjection.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;col_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;list of columns name to project the obs of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to project specific rows of obs&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject projected by list on obs&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="ObsProjection.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsProjection.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="ObsProjection.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsProjection.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Obs - Projection&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Extract a sub-DataFrame using a list of columns over the Obs DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">extractor</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataProjectionList</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_col_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_obs</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_obs</span><span class="p">(</span><span class="n">extractor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="ObsAddColumn"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsAddColumn">[docs]</a><span class="k">class</span> <span class="nc">ObsAddColumn</span><span class="p">(</span><span class="n">DataObjectObs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add to DataObject&#39;s Observations a new column</span>
<span class="sd">        It is not neccesary control that the rest of the data match with new Observations.</span>
<span class="sd">        Add new column doesn&#39;t affect the rest of the DataObject</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param name_column: Name of the new column</span>
<span class="sd">    :type name_column: str</span>
<span class="sd">    :param values: values of the new column. Must have the same lenght as number of rows of Observations</span>
<span class="sd">    :type values: list, ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_column</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span> <span class="o">=</span> <span class="n">name_column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">values</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="ObsAddColumn.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsAddColumn.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="ObsAddColumn.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsAddColumn.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name_column&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="ObsAddColumn.get_name_column"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsAddColumn.get_name_column">[docs]</a>    <span class="k">def</span> <span class="nf">get_name_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the new column</span>

<span class="sd">        :return: Name of the new column</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span></div>

<div class="viewcode-block" id="ObsAddColumn.get_values"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsAddColumn.get_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of values to initialize the new column</span>

<span class="sd">        :return: A list with the values of new column</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="ObsAddColumn.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsAddColumn.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name_column&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;name of the new column&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;values of the new column. Must have the same lenght as number of rows of obs&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new column with its values will be added to this dataframe&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with the new column added to obs&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="ObsAddColumn.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsAddColumn.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="ObsAddColumn.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsAddColumn.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">added</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">AddColumn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name_column</span><span class="p">(),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_obs</span><span class="p">())</span>

        <span class="c1"># Add a column doesn&#39;t affect the rest of the DataObject</span>
        <span class="n">dobj</span><span class="o">.</span><span class="n">set_obs</span><span class="p">(</span><span class="n">added</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="ObsReplace"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsReplace">[docs]</a><span class="k">class</span> <span class="nc">ObsReplace</span><span class="p">(</span><span class="n">DataObjectObs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace DataObject&#39;s Observations values with another.</span>
<span class="sd">        Control that the rest of the data match with new Observations</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param to_replace: values to be replaced</span>
<span class="sd">    :type to_replace: str, float, int, bool, list, ndarray</span>
<span class="sd">    :param replaced_by: new value to replaced the value before</span>
<span class="sd">    :type replaced_by: str, float, int, bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_replace</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span> <span class="n">replaced_by</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span> <span class="o">=</span> <span class="n">to_replace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span> <span class="o">=</span> <span class="n">replaced_by</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="ObsReplace.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsReplace.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_replace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;replaced_by&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="ObsReplace.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsReplace.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_replace&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;replaced_by&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="ObsReplace.get_to_replace"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsReplace.get_to_replace">[docs]</a>    <span class="k">def</span> <span class="nf">get_to_replace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value to search to replace</span>

<span class="sd">        :return: a value to be replace</span>
<span class="sd">        :rtype: str, float, int, bool, list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span></div>

<div class="viewcode-block" id="ObsReplace.get_replaced_by"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsReplace.get_replaced_by">[docs]</a>    <span class="k">def</span> <span class="nf">get_replaced_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new value</span>

<span class="sd">        :return: a value replace</span>
<span class="sd">        :rtype: str, float, int, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span></div>

<div class="viewcode-block" id="ObsReplace.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsReplace.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;to_replace&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;values to be replaced&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;replaced_by&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new value to replaced the value before&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to replace values on Obs&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with replaced values on Obs&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="ObsReplace.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsReplace.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="ObsReplace.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsReplace.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Obs - Replace Values&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Replace value(s) of the Obs DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">replace</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_replace</span><span class="p">(),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">get_replaced_by</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_obs</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_obs</span><span class="p">(</span><span class="n">replace</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="ObsDropDuplicates"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates">[docs]</a><span class="k">class</span> <span class="nc">ObsDropDuplicates</span><span class="p">(</span><span class="n">DataObjectObs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop DataObject&#39;s Observations duplicates.</span>
<span class="sd">        Control that the rest of the data match with new Observations</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param axis: axis 0 means by rows, 1 by columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param keep: Indicates which duplicates will keep on Observations.</span>
<span class="sd">        \&quot;first\&quot; keeps only the first duplicated column/row; \&quot;last\&quot; keeps only the last duplicated column/row; False keeps both duplicated columns/rows</span>
<span class="sd">    :type keep: str, bool</span>
<span class="sd">    :param by_name: True if only evaluate the name of the column/row, False if evaluate the content of the column/row to decide if is duplicated or not</span>
<span class="sd">    :type by_name: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>  <span class="c1"># axis 0 rows, 1 columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span>  <span class="c1"># False delete both duplicates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span> <span class="o">=</span> <span class="n">by_name</span>  <span class="c1"># if True, only take into account duplicates by column/row names</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="ObsDropDuplicates.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="ObsDropDuplicates.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="ObsDropDuplicates.get_axis"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to drop duplicates</span>

<span class="sd">        :return: a number that could be 0 by rows and 1 by columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>

<div class="viewcode-block" id="ObsDropDuplicates.get_keep"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates.get_keep">[docs]</a>    <span class="k">def</span> <span class="nf">get_keep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which duplicates will keep on Observations</span>

<span class="sd">        :return: could be &quot;\&quot;first\&quot;, \&quot;last\&quot; or False</span>
<span class="sd">        :rtype: str, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span></div>

<div class="viewcode-block" id="ObsDropDuplicates.get_by_name"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates.get_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which kind of evaluation will do to know if a row or column is duplicate or not</span>

<span class="sd">        :return: True if only search by row or column name, False if analyze value of row or column</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span></div>

<div class="viewcode-block" id="ObsDropDuplicates.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;indicated 0 to row or 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;keep&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">first</span><span class="se">\&quot;</span><span class="s2"> keeps only the first duplicated column/row; </span><span class="se">\&quot;</span><span class="s2">last</span><span class="se">\&quot;</span><span class="s2"> keeps only the last duplicated column/row; False keeps both duplicated columns/rows&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;by_name&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;True if only evaluate the name of the column/row, False if evaluate the content of the column/row to decide if is duplicated or not&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to drop duplicates on Obs&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject without duplicates rows or columns on Obs&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="ObsDropDuplicates.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="ObsDropDuplicates.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.ObsDropDuplicates.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Obs - Drop Duplicates&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Remove the duplicates from the Obs DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">drop</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropDuplicates</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_obs</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_obs</span><span class="p">(</span><span class="n">drop</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">VARIABLES</span>

<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="DataObjectVars"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectVars">[docs]</a><span class="k">class</span> <span class="nc">DataObjectVars</span><span class="p">(</span><span class="n">DataObjectTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with Variables of DataObject as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="DataObjectVars.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectVars.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataObjectVars.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.DataObjectVars.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SetVars"><a class="viewcode-back" href="../../src.html#src.dataobject.SetVars">[docs]</a><span class="k">class</span> <span class="nc">SetVars</span><span class="p">(</span><span class="n">DataObjectVars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Variables to new one.</span>
<span class="sd">        Control that the rest of the data match with new Variables</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param new_var: new Gene Information</span>
<span class="sd">    :type new_var: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_var</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_var</span> <span class="o">=</span> <span class="n">new_var</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="SetVars.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.SetVars.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_var&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_var</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="SetVars.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.SetVars.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_var</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_var&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="SetVars.get_new_var"><a class="viewcode-back" href="../../src.html#src.dataobject.SetVars.get_new_var">[docs]</a>    <span class="k">def</span> <span class="nf">get_new_var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new variables</span>

<span class="sd">        :return: a dataframe with the new gene information</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_var</span></div>

<div class="viewcode-block" id="SetVars.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.SetVars.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;new_var&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new content for Vars of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to change its Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;the same DataObject with vars changed&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="SetVars.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.SetVars.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="SetVars.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.SetVars.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>

<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vars - Set&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Set method of the Vars DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_new_var</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<span class="c1"># =============================================================================</span>
<span class="c1">#                           ACCESSING VAR DATAFRAME</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="VarsSelection"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsSelection">[docs]</a><span class="k">class</span> <span class="nc">VarsSelection</span><span class="p">(</span><span class="n">DataObjectVars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Variables selecting a specific row list.</span>
<span class="sd">        Control that the rest of the data match with new Variables</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param row_list: A list with the names of the rows to keep</span>
<span class="sd">    :type row_list: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_list</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span> <span class="o">=</span> <span class="n">row_list</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="VarsSelection.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsSelection.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;row_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="VarsSelection.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsSelection.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;row_list&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="VarsSelection.get_row_list"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsSelection.get_row_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_row_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the row names to keep</span>

<span class="sd">        :return: a list with row names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span></div>

<div class="viewcode-block" id="VarsSelection.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsSelection.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;row_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;list of rows name to select the Vars of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to select specific rows of Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject selected by list on Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="VarsSelection.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsSelection.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="VarsSelection.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsSelection.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vars - Selection&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Extract a sub-DataFrame using a list of rows over the Vars DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">extractor</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataSelectionList</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_row_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_vars</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_var</span><span class="p">(</span><span class="n">extractor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="VarsProjection"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsProjection">[docs]</a><span class="k">class</span> <span class="nc">VarsProjection</span><span class="p">(</span><span class="n">DataObjectVars</span><span class="p">):</span>  <span class="c1"># Columns</span>
    <span class="sd">&quot;&quot;&quot;Set DataObject&#39;s Variables selecting a specific column list.</span>
<span class="sd">        Control that the rest of the data match with new Variables</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param col_list: A list with the names of the columns to keep</span>
<span class="sd">    :type col_list: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_list</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span> <span class="o">=</span> <span class="n">col_list</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="VarsProjection.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsProjection.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="VarsProjection.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsProjection.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_list&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="VarsProjection.get_col_list"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsProjection.get_col_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the column names to keep</span>

<span class="sd">        :return: a list with column names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_list</span></div>

<div class="viewcode-block" id="VarsProjection.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsProjection.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;col_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;list of columns name to project the Vars of DataObject&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to project specific rows of Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject projected by list on Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="VarsProjection.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsProjection.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="VarsProjection.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsProjection.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vars - Selection&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Extract a sub-DataFrame using a list of rows over the Vars DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">extractor</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DataProjectionList</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_col_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_vars</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_var</span><span class="p">(</span><span class="n">extractor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="VarsAddColumn"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsAddColumn">[docs]</a><span class="k">class</span> <span class="nc">VarsAddColumn</span><span class="p">(</span><span class="n">DataObjectVars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add to DataObject&#39;s Variables a new column</span>
<span class="sd">        It is not neccesary control that the rest of the data match with new Variables.</span>
<span class="sd">        Add new column doesn&#39;t affect the rest of the DataObject</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param name_column: Name of the new column</span>
<span class="sd">    :type name_column: str</span>
<span class="sd">    :param values: values of the new column. Must have the same lenght as number of rows of Variables</span>
<span class="sd">    :type values: list, ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_column</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span> <span class="o">=</span> <span class="n">name_column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">values</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="VarsAddColumn.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsAddColumn.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="VarsAddColumn.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsAddColumn.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name_column&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="VarsAddColumn.get_name_column"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsAddColumn.get_name_column">[docs]</a>    <span class="k">def</span> <span class="nf">get_name_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the new column</span>

<span class="sd">        :return: Name of the new column</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span></div>

<div class="viewcode-block" id="VarsAddColumn.get_values"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsAddColumn.get_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of values to initialize the new column</span>

<span class="sd">        :return: A list with the values of new column</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="VarsAddColumn.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsAddColumn.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name_column&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;name of the new column&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;values of the new column. Must have the same lenght as number of rows of Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new column with its values will be added to this dataframe&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with the new column added to Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="VarsAddColumn.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsAddColumn.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="VarsAddColumn.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsAddColumn.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Obs - Add New Column&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Add a new column in the Vars DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">added</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">AddColumn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name_column</span><span class="p">(),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_vars</span><span class="p">())</span>

        <span class="c1"># Add a column doesn&#39;t affect the rest of the DataObject</span>
        <span class="n">dobj</span><span class="o">.</span><span class="n">set_var</span><span class="p">(</span><span class="n">added</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="VarsReplace"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsReplace">[docs]</a><span class="k">class</span> <span class="nc">VarsReplace</span><span class="p">(</span><span class="n">DataObjectVars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace DataObject&#39;s Variables values with another.</span>
<span class="sd">        Control that the rest of the data match with new Variables</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param to_replace: values to be replaced</span>
<span class="sd">    :type to_replace: str, float, int, bool, list, ndarray</span>
<span class="sd">    :param replaced_by: new value to replaced the value before</span>
<span class="sd">    :type replaced_by: str, float, int, bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_replace</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span> <span class="n">replaced_by</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span> <span class="o">=</span> <span class="n">to_replace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span> <span class="o">=</span> <span class="n">replaced_by</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="VarsReplace.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsReplace.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_replace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;replaced_by&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="VarsReplace.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsReplace.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_replace&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;replaced_by&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="VarsReplace.get_to_replace"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsReplace.get_to_replace">[docs]</a>    <span class="k">def</span> <span class="nf">get_to_replace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value to search to replace</span>

<span class="sd">        :return: a value to be replace</span>
<span class="sd">        :rtype: str, float, int, bool, list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span></div>

<div class="viewcode-block" id="VarsReplace.get_replaced_by"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsReplace.get_replaced_by">[docs]</a>    <span class="k">def</span> <span class="nf">get_replaced_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new value</span>

<span class="sd">        :return: a value replace</span>
<span class="sd">        :rtype: str, float, int, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span></div>

<div class="viewcode-block" id="VarsReplace.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsReplace.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;to_replace&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;values to be replaced&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;replaced_by&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;new value to replaced the value before&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to replace values on Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject with replaced values on Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="VarsReplace.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsReplace.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="VarsReplace.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsReplace.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Obs - Replace Values&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Replace value(s) of the Vars DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">replace</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_replace</span><span class="p">(),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">get_replaced_by</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_vars</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_var</span><span class="p">(</span><span class="n">replace</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>


<div class="viewcode-block" id="VarsDropDuplicates"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates">[docs]</a><span class="k">class</span> <span class="nc">VarsDropDuplicates</span><span class="p">(</span><span class="n">DataObjectVars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop DataObject&#39;s Variables duplicates.</span>
<span class="sd">        Control that the rest of the data match with new Variables</span>
<span class="sd">        This class is a Task which allows generate a Workflow</span>
<span class="sd">        When this class is called, save his instance on DataObject&#39;s Log</span>

<span class="sd">    :param axis: axis 0 means by rows, 1 by columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param keep: Indicates which duplicates will keep on Observations.</span>
<span class="sd">        \&quot;first\&quot; keeps only the first duplicated column/row; \&quot;last\&quot; keeps only the last duplicated column/row; False keeps both duplicated columns/rows</span>
<span class="sd">    :type keep: str, bool</span>
<span class="sd">    :param by_name: True if only evaluate the name of the column/row, False if evaluate the content of the column/row to decide if is duplicated or not</span>
<span class="sd">    :type by_name: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>  <span class="c1"># axis 0 rows, 1 columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span>  <span class="c1"># False delete both duplicates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span> <span class="o">=</span> <span class="n">by_name</span>  <span class="c1"># if True, only take into account duplicates by column/row names</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="VarsDropDuplicates.get_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="VarsDropDuplicates.set_parameters"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="VarsDropDuplicates.get_axis"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to drop duplicates</span>

<span class="sd">        :return: a number that could be 0 by rows and 1 by columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>

<div class="viewcode-block" id="VarsDropDuplicates.get_keep"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates.get_keep">[docs]</a>    <span class="k">def</span> <span class="nf">get_keep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which duplicates will keep on Variables</span>

<span class="sd">        :return: could be &quot;\&quot;first\&quot;, \&quot;last\&quot; or False</span>
<span class="sd">        :rtype: str, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span></div>

<div class="viewcode-block" id="VarsDropDuplicates.get_by_name"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates.get_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which kind of evaluation will do to know if a row or column is duplicate or not</span>

<span class="sd">        :return: True if only search by row or column name, False if analyze value of row or column</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span></div>

<div class="viewcode-block" id="VarsDropDuplicates.get_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;indicated 0 to row or 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;keep&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">first</span><span class="se">\&quot;</span><span class="s2"> keeps only the first duplicated column/row; </span><span class="se">\&quot;</span><span class="s2">last</span><span class="se">\&quot;</span><span class="s2"> keeps only the last duplicated column/row; False keeps both duplicated columns/rows&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;by_name&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;True if only evaluate the name of the column/row, False if evaluate the content of the column/row to decide if is duplicated or not&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dobj&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject to drop duplicates on Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">DataObject</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a DataObject without duplicates rows or columns on Vars&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="VarsDropDuplicates.show_metadata"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="VarsDropDuplicates.apply"><a class="viewcode-back" href="../../src.html#src.dataobject.VarsDropDuplicates.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created and update the Workflow for the DataObject</span>

<span class="sd">        :param dobj: The current DataObject to be process</span>
<span class="sd">        :type dobj: DataObject</span>
<span class="sd">        :return: The DataObject passed with the Task applied</span>
<span class="sd">        :rtype: DataObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>

        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">()</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vars - Drop Duplicates&quot;</span><span class="p">,</span>
                                         <span class="n">descp</span><span class="o">=</span><span class="s2">&quot;Remove the duplicates from the Vars DataFrame.&quot;</span><span class="p">)</span>

        <span class="n">drop</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">DropDuplicates</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dobj</span><span class="o">.</span><span class="n">get_vars</span><span class="p">())</span>

        <span class="n">dobj</span><span class="o">.</span><span class="n">set_var</span><span class="p">(</span><span class="n">drop</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dobj</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Alba Casillas Rodr√≠guez.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    .wy-nav-content-wrap {
        height: 100%;
        width: 100%;
        background: hsl(0, 0%, 100%);
        display: block;
    }

    .wy-nav-content {
        height: 100%;
        width: 100%;
        background: hsl(0, 0%, 100%);
    }

    .rst-content {
        width: 100%;
        height: 100%;
    }

    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search,
    .wy-nav-top {
        background: hsl(0, 2%, 10%);
    }

    /* Sidebar */
    .wy-nav-side {
        background: #85e4a5;
    }

    .caption {
        background: hsl(0, 0%, 100%);
    }

    .caption-text {
        color: hsl(0, 0%, 0%)
    }

    .wy-menu-vertical a {
        color: hsl(0, 0%, 0%)
    }

    .wy-menu-vertical a:hover {
        color: hsl(0, 0%, 100%)
    }
</style>


</body>
</html>