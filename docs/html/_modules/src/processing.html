<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.processing &mdash; GeneFlow 0.8 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html"><img src="../../_static/geneflow_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">GeneFlow:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../geneflow.html">GeneFlow</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../src.html">DataObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.etl">ETL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.model">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.objects">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.processing">Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.utils">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src.html#module-src.visualize">Visualize</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeneFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>src.processing</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.processing</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">@author: Alba Casillas Rodr√≠guez (albacaro@correo.ugr.es)</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stat</span>
<span class="kn">from</span> <span class="nn">src</span> <span class="kn">import</span> <span class="n">utils</span> <span class="k">as</span> <span class="n">ut</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">import_module</span>


<span class="c1">#from rnalysis import filtering</span>

<div class="viewcode-block" id="Task"><a class="viewcode-back" href="../../src.html#src.processing.Task">[docs]</a><span class="k">class</span> <span class="nc">Task</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation of all Task on API development.</span>
<span class="sd">        All other project tasks inherit from it.</span>
<span class="sd">        The parameterization of a Task allows the instantiation of any child of Task with only its name.</span>
<span class="sd">        It is possible to generate the Reflection technique, and instantiation of the Child Task</span>
<span class="sd">        to be done from the base class (Task) without the need to duplicate code</span>
<span class="sd">        and organize all Task by the same pattern.</span>

<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
<div class="viewcode-block" id="Task.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Task.get_parameters">[docs]</a>    <span class="nd">@abstractmethod</span>    
    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow parameterization of a Task</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span> </div>

<div class="viewcode-block" id="Task.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Task.set_parameters">[docs]</a>    <span class="nd">@abstractmethod</span>    
    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Will update the values of parameters of a Task</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span> </div>

    <span class="c1"># Ejecucion de las tareas</span>

<div class="viewcode-block" id="Task.apply"><a class="viewcode-back" href="../../src.html#src.processing.Task.apply">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Will be the main function of a Task to realize a specific job</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="c1"># I/O    </span>
<div class="viewcode-block" id="Task.instantiate"><a class="viewcode-back" href="../../src.html#src.processing.Task.instantiate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">instantiate</span><span class="p">(</span><span class="n">class_str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Instantiate a class object of a Task by its path class</span>

<span class="sd">        :param class_str: the name of the class</span>
<span class="sd">        :type class_str: str</span>

<span class="sd">        :return: a instance of a Task</span>
<span class="sd">        :rtype: Task</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Class reflection</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">module_path</span><span class="p">,</span> <span class="n">class_name</span> <span class="o">=</span> <span class="n">class_str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">module</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ImportError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">class_str</span><span class="p">)</span>        
        <span class="c1"># Dynamic instantiation</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">klass</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">instance</span></div>
    
<div class="viewcode-block" id="Task.to_dict"><a class="viewcode-back" href="../../src.html#src.processing.Task.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate a dictionary from its parameters and generate a readable structure</span>
<span class="sd">            to replicate a Task Object later</span>

<span class="sd">        :return: a json object with the element of a Task organizes</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">json</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">json</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">json</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">json</span> </div>

<div class="viewcode-block" id="Task.from_dict"><a class="viewcode-back" href="../../src.html#src.processing.Task.from_dict">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read a dictionary (or json structure) and create a Object Task</span>
<span class="sd">            with all values which the previous object Task was saved.</span>
<span class="sd">            It is the method that allows replicate any child of Task only knowing this class</span>

<span class="sd">        :return: a replicate instance of the Task previosly saved on a json file or dictionary</span>
<span class="sd">        :rtype: Task</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Dynamic instantiation &amp; parameterization</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">Task</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span></div>

    <span class="k">def</span> <span class="fm">__str__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allows stream a Task on output</span>

<span class="sd">        :return: a dictionary transform to readable str</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span></div>



<div class="viewcode-block" id="DataTask"><a class="viewcode-back" href="../../src.html#src.processing.DataTask">[docs]</a><span class="k">class</span> <span class="nc">DataTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with DataFrame as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="DataTask.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataTask.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>
<span class="sd">        </span>
<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">return</span> <span class="n">parameters</span></div></div>
    

<div class="viewcode-block" id="ListTask"><a class="viewcode-back" href="../../src.html#src.processing.ListTask">[docs]</a><span class="k">class</span> <span class="nc">ListTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with List or Aarray as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>
<span class="sd">        </span>
<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="ListTask.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.ListTask.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">parameters</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">return</span> <span class="n">parameters</span></div></div>



<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">######################################################</span>

<span class="sd">                OPERATIONS WITH DATA</span>

<span class="sd">######################################################</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># =============================================================================</span>
<span class="c1">#                               ACCESS</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="DataColumnames"><a class="viewcode-back" href="../../src.html#src.processing.DataColumnames">[docs]</a><span class="k">class</span> <span class="nc">DataColumnames</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns list of the columns of the a DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>  

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataColumnames.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataColumnames.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataColumnames.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataColumnames.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataColumnames.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataColumnames.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Name of columns&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataColumnames.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataColumnames.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># A list of the columns of the dataframe is returned</span>
<div class="viewcode-block" id="DataColumnames.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataColumnames.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A list of the columns of the dataframe</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input variable must be a dataframe.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>
     
            
<div class="viewcode-block" id="DataRownames"><a class="viewcode-back" href="../../src.html#src.processing.DataRownames">[docs]</a><span class="k">class</span> <span class="nc">DataRownames</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns list of the rows of the a DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>  

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataRownames.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataRownames.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataRownames.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataRownames.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataRownames.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataRownames.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Name of columns&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataRownames.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataRownames.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># A list of the rows of the dataframe is returned</span>
<div class="viewcode-block" id="DataRownames.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataRownames.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A list of the rows of the dataframe</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataExplainVariable"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariable">[docs]</a><span class="k">class</span> <span class="nc">DataExplainVariable</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a DataFrame, return all information associated to a variable (row)</span>
<span class="sd">        </span>
<span class="sd">    :param var_id: identificator to select a specific variable</span>
<span class="sd">    :type var_id: str, int, float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_id</span><span class="p">):</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_id</span> <span class="o">=</span> <span class="n">var_id</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataExplainVariable.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariable.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;var_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_id</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataExplainVariable.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariable.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_id</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;var_id&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataExplainVariable.get_var_id"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariable.get_var_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_var_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the identificator of the specific variable</span>

<span class="sd">        :return: the identificadot</span>
<span class="sd">        :rtype: str, int, float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_id</span></div>


<div class="viewcode-block" id="DataExplainVariable.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariable.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;var_id&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;ID of the variable to explain&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;samples&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame with information to explain&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Explained information about a variable&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>
    

<div class="viewcode-block" id="DataExplainVariable.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariable.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># A list of the rows of the dataframe is returned</span>
<div class="viewcode-block" id="DataExplainVariable.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariable.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a dataframe o series with information associated to this variable</span>
<span class="sd">        :rtype: DataFrame, Series</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DataSelectionName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_var_id</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input variable must be a dataframe.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataExplainVariableColname"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariableColname">[docs]</a><span class="k">class</span> <span class="nc">DataExplainVariableColname</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a DataFrame, return a certain information associated to a variable (row)</span>
<span class="sd">        </span>
<span class="sd">    :param var_id: identificator to select a specific variable</span>
<span class="sd">    :type var_id: str, int, float</span>
<span class="sd">    :param colnm: name of the column to extract that information</span>
<span class="sd">    :type colnm: str, int, float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">colnm</span><span class="p">):</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_id</span> <span class="o">=</span> <span class="n">var_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colnm</span> <span class="o">=</span> <span class="n">colnm</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataExplainVariableColname.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariableColname.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;var_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_id</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;colnm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colnm</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataExplainVariableColname.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariableColname.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_id</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;var_id&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colnm</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;colnm&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataExplainVariableColname.get_var_id"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariableColname.get_var_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_var_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the identificator of the specific variable</span>

<span class="sd">        :return: the identificadot</span>
<span class="sd">        :rtype: str, int, float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_id</span></div>
    
<div class="viewcode-block" id="DataExplainVariableColname.get_colnm"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariableColname.get_colnm">[docs]</a>    <span class="k">def</span> <span class="nf">get_colnm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the column to extract certain information</span>

<span class="sd">        :return: name of the column</span>
<span class="sd">        :rtype: str, int, float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">colnm</span></div>


<div class="viewcode-block" id="DataExplainVariableColname.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariableColname.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;var_id&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;ID of the variable to explain&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;colnm&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Name of the column to extract variable&#39;s information&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;samples&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame with information to explain&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Explained information from column about a variable&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>
    

<div class="viewcode-block" id="DataExplainVariableColname.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariableColname.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># A list of the rows of the dataframe is returned</span>
<div class="viewcode-block" id="DataExplainVariableColname.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainVariableColname.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a dataframe o series with information associated to this variable and its column</span>
<span class="sd">        :rtype: DataFrame, Series</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">DataExplainVariable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_var_id</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">DataProjectionName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_colnm</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input variable must be a dataframe.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataExplainAllVariableColname"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainAllVariableColname">[docs]</a><span class="k">class</span> <span class="nc">DataExplainAllVariableColname</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a DataFrame, return a certain information of all variables</span>
<span class="sd">        </span>
<span class="sd">    :param colnm: name of the column to extract that information</span>
<span class="sd">    :type colnm: str, int, float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colnm</span><span class="p">):</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colnm</span> <span class="o">=</span> <span class="n">colnm</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataExplainAllVariableColname.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainAllVariableColname.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;colnm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colnm</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataExplainAllVariableColname.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainAllVariableColname.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colnm</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;colnm&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>
    
<div class="viewcode-block" id="DataExplainAllVariableColname.get_colnm"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainAllVariableColname.get_colnm">[docs]</a>    <span class="k">def</span> <span class="nf">get_colnm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the column to extract certain information</span>

<span class="sd">        :return: name of the column</span>
<span class="sd">        :rtype: str, int, float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">colnm</span></div>


<div class="viewcode-block" id="DataExplainAllVariableColname.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainAllVariableColname.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;colnm&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Name of the column to extract variable&#39;s information&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;samples&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame with information to explain&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Explained information from column about all variables&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataExplainAllVariableColname.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainAllVariableColname.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="DataExplainAllVariableColname.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataExplainAllVariableColname.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a dataframe o series with information associated to all variables and their column</span>
<span class="sd">        :rtype: DataFrame, Series</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">DataProjectionName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_colnm</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input variable must be a dataframe.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                               CHECKING</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="CheckElement"><a class="viewcode-back" href="../../src.html#src.processing.CheckElement">[docs]</a><span class="k">class</span> <span class="nc">CheckElement</span><span class="p">(</span><span class="n">ListTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if a given element is on a list or array</span>
<span class="sd">        </span>
<span class="sd">    :param element: element to find on a list</span>
<span class="sd">    :type element: int, float, str, bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">element</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CheckElement.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CheckElement.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;element&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CheckElement.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CheckElement.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;element&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CheckElement.get_element"><a class="viewcode-back" href="../../src.html#src.processing.CheckElement.get_element">[docs]</a>    <span class="k">def</span> <span class="nf">get_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the element to find on a list</span>

<span class="sd">        :return: a element to find</span>
<span class="sd">        :rtype: int, float, str, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span></div>


<div class="viewcode-block" id="CheckElement.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CheckElement.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;element&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;element to find on a list&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a list to find a element&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;True if element is on list, False if not on list&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="CheckElement.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CheckElement.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Check if a value is in the list</span>
<div class="viewcode-block" id="CheckElement.apply"><a class="viewcode-back" href="../../src.html#src.processing.CheckElement.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param list_: The current list to be process</span>
<span class="sd">        :type list_: list</span>
<span class="sd">        :return: True if element is on a list, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_element</span><span class="p">())</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
    
            <span class="k">return</span> <span class="kc">True</span>
        
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Element have not the same type of list elements&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>
        
        
        
<div class="viewcode-block" id="CheckAllElement"><a class="viewcode-back" href="../../src.html#src.processing.CheckAllElement">[docs]</a><span class="k">class</span> <span class="nc">CheckAllElement</span><span class="p">(</span><span class="n">ListTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if a given list of elements are on a list or array</span>
<span class="sd">        </span>
<span class="sd">    :param sublist: list of element to find</span>
<span class="sd">    :type sublist: list, ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sublist</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span> <span class="o">=</span> <span class="n">sublist</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CheckAllElement.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CheckAllElement.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;sublist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CheckAllElement.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CheckAllElement.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;sublist&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CheckAllElement.get_sublist"><a class="viewcode-back" href="../../src.html#src.processing.CheckAllElement.get_sublist">[docs]</a>    <span class="k">def</span> <span class="nf">get_sublist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of element to find on a list</span>

<span class="sd">        :return: a list of element to find</span>
<span class="sd">        :rtype: list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span></div>


<div class="viewcode-block" id="CheckAllElement.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CheckAllElement.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;sublist&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list with element to check&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a list to find a list of element&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;True if all element is on list, False if not&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="CheckAllElement.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CheckAllElement.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Return TRUE if all elements in sublist are in list_</span>
<div class="viewcode-block" id="CheckAllElement.apply"><a class="viewcode-back" href="../../src.html#src.processing.CheckAllElement.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param list_: The current list to be process</span>
<span class="sd">        :type list_: list</span>
<span class="sd">        :return: True if all elements is on a list, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="c1"># Types of both list must coincide</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">elem</span> <span class="ow">in</span> <span class="n">list_</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sublist</span><span class="p">())</span>
        
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elements of the list extract have not the same type&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>
            
            
<div class="viewcode-block" id="CheckSubElement"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElement">[docs]</a><span class="k">class</span> <span class="nc">CheckSubElement</span><span class="p">(</span><span class="n">ListTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;It receives a list with elements where it is only needed to find </span>
<span class="sd">        a SUBSTRING of the name to be valid.</span>
<span class="sd">        </span>
<span class="sd">    :param partial_sublist: list of element to find without need to match all name</span>
<span class="sd">    :type partial_sublist: list, ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partial_sublist</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partial_sublist</span> <span class="o">=</span> <span class="n">partial_sublist</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CheckSubElement.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElement.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;partial_sublist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">partial_sublist</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CheckSubElement.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElement.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partial_sublist</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;partial_sublist&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CheckSubElement.get_partial_sublist"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElement.get_partial_sublist">[docs]</a>    <span class="k">def</span> <span class="nf">get_partial_sublist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of element to find on a list</span>

<span class="sd">        :return: a list of element to find</span>
<span class="sd">        :rtype: list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">partial_sublist</span></div>


<div class="viewcode-block" id="CheckSubElement.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElement.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;partial_sublist&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list with element to search&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a list to find a list of element&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;A list with the coincidence substring&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="CheckSubElement.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElement.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># It receives a list with elements where it is only needed to find </span>
    <span class="c1"># a SUBSTRING of the name to be valid.</span>
<div class="viewcode-block" id="CheckSubElement.apply"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElement.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param list_: The current list to be process</span>
<span class="sd">        :type list_: list</span>
<span class="sd">        :return: a list of coincidence with the large name</span>
<span class="sd">        :rtype: list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="c1"># Avoid duplicated</span>
        <span class="n">uniques_match</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># Types of both list must coincide</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_partial_sublist</span><span class="p">():</span>
                <span class="c1"># return a list of matches</span>
                <span class="n">found</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">list_</span> <span class="k">if</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span> <span class="c1"># add value to list if exists</span>
                
                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="c1"># Add a list to set but keep only uniques</span>
                    <span class="n">uniques_match</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">found</span><span class="p">)</span>
    
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">uniques_match</span><span class="p">)</span>
    
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elements of the list extract have not the same type&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="CheckSubElementShort"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElementShort">[docs]</a><span class="k">class</span> <span class="nc">CheckSubElementShort</span><span class="p">(</span><span class="n">ListTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;It receives a list with elements where it is only needed to find </span>
<span class="sd">        a SUBSTRING of the name to be valid, but returns the short name founded</span>
<span class="sd">        </span>
<span class="sd">    :param partial_sublist: list of element to find without need to match all name</span>
<span class="sd">    :type partial_sublist: list, ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partial_sublist</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partial_sublist</span> <span class="o">=</span> <span class="n">partial_sublist</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CheckSubElementShort.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElementShort.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;partial_sublist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">partial_sublist</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CheckSubElementShort.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElementShort.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partial_sublist</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;partial_sublist&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CheckSubElementShort.get_partial_sublist"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElementShort.get_partial_sublist">[docs]</a>    <span class="k">def</span> <span class="nf">get_partial_sublist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of element to find on a list</span>

<span class="sd">        :return: a list of element to find</span>
<span class="sd">        :rtype: list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">partial_sublist</span></div>

    <span class="c1"># Execution</span>
    
<div class="viewcode-block" id="CheckSubElementShort.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElementShort.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;partial_sublist&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list with element to search&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a list to find a list of element&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a list with coincidence almost partial&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="CheckSubElementShort.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElementShort.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


<div class="viewcode-block" id="CheckSubElementShort.apply"><a class="viewcode-back" href="../../src.html#src.processing.CheckSubElementShort.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param list_: The current list to be process</span>
<span class="sd">        :type list_: list</span>
<span class="sd">        :return: a list of coincidence with the short name</span>
<span class="sd">        :rtype: list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">uniques_match</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># Types of both list must coincide</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
                <span class="c1"># return a list of matches</span>
                <span class="n">found</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_partial_sublist</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">elem</span><span class="p">]</span> <span class="c1"># add value to list if exists</span>
                
                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="c1"># Add a list to set but keep only uniques</span>
                    <span class="n">uniques_match</span><span class="p">[</span><span class="n">elem</span><span class="p">]</span> <span class="o">=</span> <span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
            <span class="k">return</span> <span class="n">uniques_match</span>
    
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elements of the list extract have not the same type.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                               EXTRACTION</span>
<span class="c1"># =============================================================================</span>


<span class="c1"># extract_subdf_by_columns == Projection</span>
<span class="c1"># Projection means choosing which columns (or expressions) the query shall return.</span>

<div class="viewcode-block" id="DataProjectionList"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionList">[docs]</a><span class="k">class</span> <span class="nc">DataProjectionList</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a specific column list.</span>
<span class="sd">        </span>
<span class="sd">    :param column_list: A list with the names of the columns to keep</span>
<span class="sd">    :type column_list: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_list</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_list</span> <span class="o">=</span> <span class="n">column_list</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataProjectionList.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionList.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;column_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_list</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataProjectionList.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionList.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;column_list&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataProjectionList.get_column_list"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionList.get_column_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_column_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the column names to keep</span>

<span class="sd">        :return: a list with column names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_list</span></div>


<div class="viewcode-block" id="DataProjectionList.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionList.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;column_list&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list columns name to project&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to project specific columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe projected by list&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataProjectionList.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionList.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Create a subdataframe from a dataframe with the selected columns in col_list</span>
<div class="viewcode-block" id="DataProjectionList.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionList.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrane</span>
<span class="sd">        :return: a Sub-DataFrame with selected columns</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="n">data_columns</span> <span class="o">=</span> <span class="n">DataColumnames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            
            <span class="n">inters</span> <span class="o">=</span> <span class="n">ListIntersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data_columns</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">inters</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input data must be a dataframe&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataProjectionIndex"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionIndex">[docs]</a><span class="k">class</span> <span class="nc">DataProjectionIndex</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a specific column by index.</span>
<span class="sd">        </span>
<span class="sd">    :param indx: a number of a column. Must be on range of lenght columns</span>
<span class="sd">    :type indx: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indx</span> <span class="o">=</span> <span class="n">indx</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataProjectionIndex.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionIndex.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;indx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indx</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataProjectionIndex.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionIndex.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indx</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;indx&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataProjectionIndex.get_indx"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionIndex.get_indx">[docs]</a>    <span class="k">def</span> <span class="nf">get_indx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the column index to project</span>

<span class="sd">        :return: a index column</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indx</span></div>


<div class="viewcode-block" id="DataProjectionIndex.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionIndex.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;indx&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;index of the column&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to project specific column&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe projected by column index&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataProjectionIndex.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionIndex.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Search a column by index name</span>
<div class="viewcode-block" id="DataProjectionIndex.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionIndex.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with selected column</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indx</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indx</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>

                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indx</span><span class="p">()]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value of column number exceed columns dimension&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input data must be a dataframe&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataProjectionName"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionName">[docs]</a><span class="k">class</span> <span class="nc">DataProjectionName</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a specific column by name.</span>
<span class="sd">        </span>
<span class="sd">    :param name: a name of a column. Must exists</span>
<span class="sd">    :type name: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataProjectionName.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionName.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataProjectionName.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionName.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataProjectionName.get_name"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionName.get_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the column name to project</span>

<span class="sd">        :return: a column name</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span></div>


<div class="viewcode-block" id="DataProjectionName.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionName.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the column to project&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to project specific columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe projected by column name&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataProjectionName.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionName.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Search a column by column name</span>
<div class="viewcode-block" id="DataProjectionName.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionName.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with selected column</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            
            <span class="n">columnames</span> <span class="o">=</span> <span class="n">DataColumnames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="ow">in</span> <span class="n">columnames</span><span class="p">:</span>
        
                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">()]</span>

            <span class="k">else</span><span class="p">:</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column name &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot; does not exist in DataFrame&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input data must be a dataframe&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataProjectionRange"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionRange">[docs]</a><span class="k">class</span> <span class="nc">DataProjectionRange</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a range of columns</span>
<span class="sd">        </span>
<span class="sd">    :param ini_column: a initial position to project. Must be on range of lenght columns</span>
<span class="sd">    :type ini_column: int</span>
<span class="sd">    :param fini_column: a final position to project. Must be on range of lenght columns</span>
<span class="sd">    :type fini_column: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ini_column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fini_column</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ini_column</span> <span class="o">=</span> <span class="n">ini_column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fini_column</span> <span class="o">=</span> <span class="n">fini_column</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># + 1 for a closed interval</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataProjectionRange.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionRange.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;ini_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ini_column</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;fini_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fini_column</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataProjectionRange.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionRange.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ini_column</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;ini_column&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fini_column</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;fini_column&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataProjectionRange.get_ini_column"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionRange.get_ini_column">[docs]</a>    <span class="k">def</span> <span class="nf">get_ini_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first column to be project</span>

<span class="sd">        :return: a initial position</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ini_column</span></div>

<div class="viewcode-block" id="DataProjectionRange.get_fini_column"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionRange.get_fini_column">[docs]</a>    <span class="k">def</span> <span class="nf">get_fini_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the last column to be project</span>

<span class="sd">        :return: a last position</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fini_row</span></div>


<div class="viewcode-block" id="DataProjectionRange.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionRange.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;ini_column&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;initial value of column range&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;fini_column&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;final value of column range&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to project specific columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe projected by range&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataProjectionRange.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionRange.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Create a subdataframe from a dataframe with the selected columns in an interval</span>
<div class="viewcode-block" id="DataProjectionRange.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionRange.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with the selected columns in an interval</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ini_column</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ini_column</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_fini_column</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fini_column</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ini_column</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fini_column</span><span class="p">():</span>
                    
                    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ini_column</span><span class="p">():</span><span class="bp">self</span><span class="o">.</span><span class="n">get_fini_column</span><span class="p">()]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Init range cannot be equal or higher to final range.&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column range exceed Dataframe dimensions.&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input data must be a dataframe&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataProjectionFilter"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionFilter">[docs]</a><span class="k">class</span> <span class="nc">DataProjectionFilter</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting columns by filter.</span>
<span class="sd">        </span>
<span class="sd">    :param filter_: a filter to do the projection by columns</span>
<span class="sd">    :type filter_: pd.Series, pd.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_</span> <span class="o">=</span> <span class="n">filter_</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataProjectionFilter.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionFilter.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;filter_&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataProjectionFilter.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionFilter.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;filter_&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataProjectionFilter.get_filter"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionFilter.get_filter">[docs]</a>    <span class="k">def</span> <span class="nf">get_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the filter to project DataFrame</span>

<span class="sd">        :return: a filter</span>
<span class="sd">        :rtype: pd.Series, pd.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_</span></div>


<div class="viewcode-block" id="DataProjectionFilter.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionFilter.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;filter_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;filter to do the projection by columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to project specific columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe projected by filter&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataProjectionFilter.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionFilter.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Create a subdataframe from a dataframe with a filter</span>
<div class="viewcode-block" id="DataProjectionFilter.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionFilter.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame after apply a filter by columns</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_filter</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            
            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_filter</span><span class="p">(),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_filter</span><span class="p">(),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filter</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span></div></div>




<div class="viewcode-block" id="DataProjectionSubstring"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionSubstring">[docs]</a><span class="k">class</span> <span class="nc">DataProjectionSubstring</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a specific column list no matter if name doesn&#39;t match complete.</span>
<span class="sd">        </span>
<span class="sd">    :param column_list: A list with the names of the columns to keep</span>
<span class="sd">    :type column_list: list</span>
<span class="sd">    :param rename: check if should rename the column to the short name. True, then rename, False, not</span>
<span class="sd">    :type rename: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">rename</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_list</span> <span class="o">=</span> <span class="n">column_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename</span> <span class="o">=</span> <span class="n">rename</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataProjectionSubstring.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionSubstring.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;column_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_list</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;rename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataProjectionSubstring.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionSubstring.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;column_list&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;rename&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataProjectionSubstring.get_column_list"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionSubstring.get_column_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_column_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the column names (maybe shorter than columns DataFrame) to keep</span>

<span class="sd">        :return: a list with column names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_list</span></div>

<div class="viewcode-block" id="DataProjectionSubstring.get_rename"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionSubstring.get_rename">[docs]</a>    <span class="k">def</span> <span class="nf">get_rename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns if should rename the column to the short name</span>

<span class="sd">        :return: True if the columns of new DataFrame should rename, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename</span></div>
    

<div class="viewcode-block" id="DataProjectionSubstring.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionSubstring.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;column_list&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list columns name to project (can be shorted that column name of dataframe&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;rename&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;True if column should be renamed by short name, False if not&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to project specific columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe projected by list and renamed or not&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataProjectionSubstring.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionSubstring.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Search in the column names (that have a long string) to check if there is a</span>
    <span class="c1"># valid substring in its value.</span>
    <span class="c1"># If rename == True -&gt; rename the columns with the substring</span>
    <span class="c1"># E.g: For TCGA-E2-A1L7-11A-33R-A144-07 it will find TCGA-E2-A1L7   </span>
<div class="viewcode-block" id="DataProjectionSubstring.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataProjectionSubstring.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with selected columns</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">data_columns</span> <span class="o">=</span> <span class="n">DataColumnames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="n">coincidence</span> <span class="o">=</span> <span class="n">CheckSubElement</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data_columns</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">coincidence</span><span class="p">:</span> <span class="c1"># True if it is not empty</span>
        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rename</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">data_columns</span><span class="p">,</span> <span class="n">coincidence</span><span class="p">)]</span>
                
                <span class="n">dict_new_names</span> <span class="o">=</span> <span class="n">CheckSubElementShort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data_columns</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">dict_new_names</span><span class="p">)</span>
        
            <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">data_columns</span><span class="p">,</span> <span class="n">coincidence</span><span class="p">)]</span>
    
        <span class="k">return</span> <span class="n">data</span></div></div>



<span class="c1"># Selection means which rows are to be returned.</span>

<div class="viewcode-block" id="DataSelectionList"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionList">[docs]</a><span class="k">class</span> <span class="nc">DataSelectionList</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a specific row list.</span>
<span class="sd">        </span>
<span class="sd">    :param row_list: A list with the names of the rows to keep</span>
<span class="sd">    :type row_list: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_list</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span> <span class="o">=</span> <span class="n">row_list</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataSelectionList.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionList.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;row_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataSelectionList.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionList.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;row_list&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataSelectionList.get_row_list"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionList.get_row_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_row_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list with the row names to keep</span>

<span class="sd">        :return: a list with row names</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_list</span></div>


<div class="viewcode-block" id="DataSelectionList.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionList.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;row_list&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list of rows name to select&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to select specific rows&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe selected by list&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataSelectionList.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionList.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Create a subdataframe from a dataframe with the selected rows in row_list</span>
<div class="viewcode-block" id="DataSelectionList.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionList.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with selected rows</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">data_rows</span> <span class="o">=</span> <span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="n">inters</span> <span class="o">=</span> <span class="n">ListIntersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_row_list</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data_rows</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inters</span><span class="p">]</span></div></div>



<span class="c1"># def row_by_index(self, indx)</span>
<div class="viewcode-block" id="DataSelectionIndex"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionIndex">[docs]</a><span class="k">class</span> <span class="nc">DataSelectionIndex</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a specific row by index.</span>
<span class="sd">        </span>
<span class="sd">    :param indx: a number of a row. Must be on range of lenght row</span>
<span class="sd">    :type indx: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indx</span> <span class="o">=</span> <span class="n">indx</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataSelectionIndex.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionIndex.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;indx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indx</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataSelectionIndex.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionIndex.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indx</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;indx&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataSelectionIndex.get_indx"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionIndex.get_indx">[docs]</a>    <span class="k">def</span> <span class="nf">get_indx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the row index to select</span>

<span class="sd">        :return: a row index</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indx</span></div>


<div class="viewcode-block" id="DataSelectionIndex.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionIndex.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;indx&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;index of the row&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to select specific row&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe selected by row index&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataSelectionIndex.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionIndex.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Search a row by index name</span>
<div class="viewcode-block" id="DataSelectionIndex.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionIndex.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with selected row</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indx</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indx</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            
                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_indx</span><span class="p">()]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="c1"># DataFrame</span>

            <span class="k">else</span><span class="p">:</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value of row number exceed rows dimension&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input data must be a dataframe&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataSelectionName"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionName">[docs]</a><span class="k">class</span> <span class="nc">DataSelectionName</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a specific row by name.</span>
<span class="sd">        </span>
<span class="sd">    :param name: a name of a row. Must exists</span>
<span class="sd">    :type name: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataSelectionName.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionName.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataSelectionName.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionName.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataSelectionName.get_name"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionName.get_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the row name to select</span>

<span class="sd">        :return: a row name</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span></div>


<div class="viewcode-block" id="DataSelectionName.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionName.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the row to select&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to select specific columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe selected by row name&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataSelectionName.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionName.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Search a row by row name</span>
<div class="viewcode-block" id="DataSelectionName.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionName.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with selected row</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
            
        <span class="n">rownames</span> <span class="o">=</span> <span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="ow">in</span> <span class="n">rownames</span><span class="p">:</span>
    
            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">()]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>

        <span class="k">else</span><span class="p">:</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row name &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot; does not exist in DataFrame&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>




<div class="viewcode-block" id="DataSelectionRange"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionRange">[docs]</a><span class="k">class</span> <span class="nc">DataSelectionRange</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a range of rows</span>
<span class="sd">        </span>
<span class="sd">    :param ini_row: a initial position to select. Must be on range of lenght rows</span>
<span class="sd">    :type ini_row: int</span>
<span class="sd">    :param fini_row: a final position to select. Must be on range of lenght rows</span>
<span class="sd">    :type fini_row: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ini_row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fini_row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ini_row</span> <span class="o">=</span> <span class="n">ini_row</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fini_row</span> <span class="o">=</span> <span class="n">fini_row</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># + 1 for a closed interval</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataSelectionRange.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionRange.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;ini_row&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ini_row</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;fini_row&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fini_row</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataSelectionRange.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionRange.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ini_row</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;ini_row&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fini_row</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;fini_row&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataSelectionRange.get_ini_row"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionRange.get_ini_row">[docs]</a>    <span class="k">def</span> <span class="nf">get_ini_row</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first row to be select</span>

<span class="sd">        :return: a initial position</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ini_row</span></div>

<div class="viewcode-block" id="DataSelectionRange.get_fini_row"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionRange.get_fini_row">[docs]</a>    <span class="k">def</span> <span class="nf">get_fini_row</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the last row to be select</span>

<span class="sd">        :return: a last position</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fini_row</span></div>


<div class="viewcode-block" id="DataSelectionRange.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionRange.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;ini_row&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;initial value of row range&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;fini_row&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;final value of row range&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to select specific rows&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe selected by range&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataSelectionRange.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionRange.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Create a subdataframe from a dataframe with the selected rows in an interval</span>
<div class="viewcode-block" id="DataSelectionRange.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionRange.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with the selected rows in an interval</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ini_row</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ini_row</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_fini_row</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fini_row</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ini_row</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fini_row</span><span class="p">():</span>
                
                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ini_row</span><span class="p">():</span><span class="bp">self</span><span class="o">.</span><span class="n">get_fini_row</span><span class="p">()]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Init range cannot be equal or higher to final range.&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row range exceed Dataframe dimensions.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataSelectionFilter"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionFilter">[docs]</a><span class="k">class</span> <span class="nc">DataSelectionFilter</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting rows by filter.</span>
<span class="sd">        </span>
<span class="sd">    :param filter_: a filter to do the selection by rows</span>
<span class="sd">    :type filter_: pd.Series, pd.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_</span> <span class="o">=</span> <span class="n">filter_</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataSelectionFilter.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionFilter.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;filter_&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataSelectionFilter.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionFilter.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;filter_&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataSelectionFilter.get_filter"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionFilter.get_filter">[docs]</a>    <span class="k">def</span> <span class="nf">get_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the filter to select DataFrame</span>

<span class="sd">        :return: a filter</span>
<span class="sd">        :rtype: pd.Series, pd.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_</span></div>


<div class="viewcode-block" id="DataSelectionFilter.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionFilter.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;filter_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;filter to do the selection by rows&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to select specific rows&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe projected by filter&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataSelectionFilter.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionFilter.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Create a subdataframe from a dataframe with a filter</span>
<div class="viewcode-block" id="DataSelectionFilter.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionFilter.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame after apply a filter by rows</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_filter</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            
            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_filter</span><span class="p">())</span>
        
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_filter</span><span class="p">(),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_filter</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">]</span></div></div>



<div class="viewcode-block" id="DataSelectionSeries"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionSeries">[docs]</a><span class="k">class</span> <span class="nc">DataSelectionSeries</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selecting a specific row by series.</span>
<span class="sd">        </span>
<span class="sd">    :param series: A series with a structure to keep</span>
<span class="sd">    :type series: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">series</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="n">series</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataSelectionSeries.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionSeries.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataSelectionSeries.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionSeries.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataSelectionSeries.get_series"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionSeries.get_series">[docs]</a>    <span class="k">def</span> <span class="nf">get_series</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the series object with the rows to keep</span>

<span class="sd">        :return: a series with rows</span>
<span class="sd">        :rtype: Series</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span></div>


<div class="viewcode-block" id="DataSelectionSeries.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionSeries.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;series&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;series to select&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to select specific rows&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe projected by series&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataSelectionSeries.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionSeries.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Create a subdataframe from a dataframe with the selected rows in series</span>
<div class="viewcode-block" id="DataSelectionSeries.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataSelectionSeries.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame with selected rows</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_series</span><span class="p">()]</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                               FILTERING</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="FilterByIndex"><a class="viewcode-back" href="../../src.html#src.processing.FilterByIndex">[docs]</a><span class="k">class</span> <span class="nc">FilterByIndex</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a Sub-DataFrame selected by a filter of index condition.</span>
<span class="sd">        For multi-index cases:</span>
<span class="sd">        index_cond must have index type (it is returned after  do dataframe.index)</span>
<span class="sd">        It keeps only the rows that are in index_cond</span>
<span class="sd">        </span>
<span class="sd">    :param index_cond: a condition as filter</span>
<span class="sd">    :type index_cond: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_cond</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_cond</span> <span class="o">=</span> <span class="n">index_cond</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="FilterByIndex.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.FilterByIndex.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_cond&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_cond</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="FilterByIndex.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.FilterByIndex.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_cond</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_cond&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="FilterByIndex.get_index_cond"><a class="viewcode-back" href="../../src.html#src.processing.FilterByIndex.get_index_cond">[docs]</a>    <span class="k">def</span> <span class="nf">get_index_cond</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the condition used to filter a DataFrame</span>

<span class="sd">        :return: a condition used</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_cond</span></div>
    

<div class="viewcode-block" id="FilterByIndex.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.FilterByIndex.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;index_cond&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a condition to filter a dataframe&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to filter&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe filtered&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="FilterByIndex.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.FilterByIndex.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
                
    <span class="c1"># For multi-index cases:</span>
    <span class="c1"># index_cond must have index type (it is returned after</span>
    <span class="c1"># do dataframe.index)</span>
    <span class="c1"># It keeps only the rows that are in index_cond</span>
<div class="viewcode-block" id="FilterByIndex.apply"><a class="viewcode-back" href="../../src.html#src.processing.FilterByIndex.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrane to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a Sub-DataFrame that keeps only the rows that are in index_cond</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index_cond</span><span class="p">())]</span>

        <span class="k">return</span> <span class="n">data</span></div></div>



<div class="viewcode-block" id="FilterDictionary"><a class="viewcode-back" href="../../src.html#src.processing.FilterDictionary">[docs]</a><span class="k">class</span> <span class="nc">FilterDictionary</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a Dictionary, select only elements on a passed list</span>
<span class="sd">        </span>
<span class="sd">    :param list_var: new Count Matrix</span>
<span class="sd">    :type list_var: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_var</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_var</span> <span class="o">=</span> <span class="n">list_var</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="FilterDictionary.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.FilterDictionary.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;list_var&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_var</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="FilterDictionary.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.FilterDictionary.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_var</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;list_var&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="FilterDictionary.get_list"><a class="viewcode-back" href="../../src.html#src.processing.FilterDictionary.get_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of elements to keep on dictionary</span>

<span class="sd">        :return: a list wit the elements selected</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_var</span></div>
    

<div class="viewcode-block" id="FilterDictionary.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.FilterDictionary.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_var&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list of elements to filter a dictionary&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dict_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dictionary to filter&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dictionary filtered by list&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="FilterDictionary.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.FilterDictionary.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="FilterDictionary.apply"><a class="viewcode-back" href="../../src.html#src.processing.FilterDictionary.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param dict_: The current Dictionary to be process</span>
<span class="sd">        :type dict_: dict</span>
<span class="sd">        :return: A new dictionary with filtered elements</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">filter_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_list</span><span class="p">(),</span> <span class="n">dict_</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

        <span class="k">return</span> <span class="n">filter_dict</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                             INTERSECTION</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="ListIntersection"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersection">[docs]</a><span class="k">class</span> <span class="nc">ListIntersection</span><span class="p">(</span><span class="n">ListTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Obtains a new list with commom elements of two list or array</span>
<span class="sd">        </span>
<span class="sd">    :param sublist: secondary list to find commom elements</span>
<span class="sd">    :type sublist: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sublist</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span> <span class="o">=</span> <span class="n">sublist</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="ListIntersection.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersection.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;sublist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="ListIntersection.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersection.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;sublist&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="ListIntersection.get_sublist"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersection.get_sublist">[docs]</a>    <span class="k">def</span> <span class="nf">get_sublist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the secondary list</span>

<span class="sd">        :return: a list with elements</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span></div>


<div class="viewcode-block" id="ListIntersection.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersection.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;sublist&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;second list to do a intersection&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a primary list&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;element that match in both list&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="ListIntersection.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersection.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Return a list which is the intersection between both input lists</span>
<div class="viewcode-block" id="ListIntersection.apply"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersection.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param list_: The primary list to be process</span>
<span class="sd">        :type list_: list</span>
<span class="sd">        :return: A list which is the intersection between both input lists</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sublist</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">]</span>
        
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elements of the list extract have not the same type.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="ListIntersectionSubString"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersectionSubString">[docs]</a><span class="k">class</span> <span class="nc">ListIntersectionSubString</span><span class="p">(</span><span class="n">ListTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Obtains a new list with commom elements of two lists or array</span>
<span class="sd">        It is enough if only match partial name of element</span>
<span class="sd">        </span>
<span class="sd">    :param substrings: secondary list to find commom elements</span>
<span class="sd">    :type substrings: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substrings</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substrings</span> <span class="o">=</span> <span class="n">substrings</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="ListIntersectionSubString.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersectionSubString.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;substrings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrings</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="ListIntersectionSubString.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersectionSubString.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substrings</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;substrings&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="ListIntersectionSubString.get_substrings"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersectionSubString.get_substrings">[docs]</a>    <span class="k">def</span> <span class="nf">get_substrings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the secondary list</span>

<span class="sd">        :return: a list with elements</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrings</span></div>


<div class="viewcode-block" id="ListIntersectionSubString.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersectionSubString.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;substrings&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;second list to do a intersection&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a primary list&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;element that match in both list at least part of the name of element in principal list&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="ListIntersectionSubString.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersectionSubString.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Find  common substring between lsubstrings and lstrings</span>
<div class="viewcode-block" id="ListIntersectionSubString.apply"><a class="viewcode-back" href="../../src.html#src.processing.ListIntersectionSubString.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param list_: The primary list to be process</span>
<span class="sd">        :type list_: list</span>
<span class="sd">        :return: A list with founded common substring between two list</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_substrings</span><span class="p">(),</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_substrings</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="p">:</span>
            
            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        
            <span class="k">for</span> <span class="n">lit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_substrings</span><span class="p">():</span>
                
                <span class="c1"># re.search() will search the regular expression pattern checking </span>
                <span class="c1"># all lines of the input string. It will return a match object</span>
                <span class="c1"># when the pattern is found and &quot;null&quot; if the pattern is not found</span>
                <span class="n">file_search</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">fl</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">lit</span><span class="p">,</span> <span class="n">fl</span><span class="p">),</span> <span class="n">list_</span><span class="p">))</span>
                
                <span class="n">file_search</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lit</span><span class="p">),</span> <span class="n">file_search</span><span class="p">))</span>
                
                <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="n">file_search</span>
            
            <span class="k">return</span> <span class="n">res</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Both parameters must be lists&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                                ZIP</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="ListZip"><a class="viewcode-back" href="../../src.html#src.processing.ListZip">[docs]</a><span class="k">class</span> <span class="nc">ListZip</span><span class="p">(</span><span class="n">ListTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a new dictionary using one list</span>
<span class="sd">        for the keys, and other to its values</span>
<span class="sd">        </span>
<span class="sd">    :param sublist: a list with values of the dictionary</span>
<span class="sd">    :type sublist: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sublist</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span> <span class="o">=</span> <span class="n">sublist</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="ListZip.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.ListZip.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;sublist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="ListZip.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.ListZip.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;sublist&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="ListZip.get_sublist"><a class="viewcode-back" href="../../src.html#src.processing.ListZip.get_sublist">[docs]</a>    <span class="k">def</span> <span class="nf">get_sublist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list that will be values of the new dictionary</span>

<span class="sd">        :return: a list with dictionary values</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sublist</span></div>


<div class="viewcode-block" id="ListZip.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.ListZip.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;sublist&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list of elements that will be values of dictionary&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a list that will be keys of dictionary&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dictionary created by both list&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="ListZip.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.ListZip.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Dictionary returned zipping two list with same length  </span>
<div class="viewcode-block" id="ListZip.apply"><a class="viewcode-back" href="../../src.html#src.processing.ListZip.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param list_: The current list to be process</span>
<span class="sd">        :type list_: list</span>
<span class="sd">        :return: with the current list used as keys, creates and returns a dictionary with second list as values</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_sublist</span><span class="p">())):</span>
            
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sublist</span><span class="p">()))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to zip the list. Check list&#39;s length.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DataZip"><a class="viewcode-back" href="../../src.html#src.processing.DataZip">[docs]</a><span class="k">class</span> <span class="nc">DataZip</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a dictionary using information about two columns</span>
<span class="sd">        of a DataFrame</span>
<span class="sd">        </span>
<span class="sd">    :param key_column: column name of a DataFrame used for the dictionary keys</span>
<span class="sd">    :type key_column: str</span>
<span class="sd">    :param values_column: column name of a DataFrame used for the dictionary values</span>
<span class="sd">    :type values_column: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_column</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">values_column</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_column</span> <span class="o">=</span> <span class="n">key_column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values_column</span> <span class="o">=</span> <span class="n">values_column</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataZip.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataZip.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;key_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_column</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;values_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_column</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataZip.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataZip.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_column</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;key_column&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values_column</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;values_column&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DataZip.get_key_column"><a class="viewcode-back" href="../../src.html#src.processing.DataZip.get_key_column">[docs]</a>    <span class="k">def</span> <span class="nf">get_key_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list that will be keys of the new dictionary</span>

<span class="sd">        :return: a list with dictionary values</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_column</span></div>

<div class="viewcode-block" id="DataZip.get_values_column"><a class="viewcode-back" href="../../src.html#src.processing.DataZip.get_values_column">[docs]</a>    <span class="k">def</span> <span class="nf">get_values_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list that will be values of the new dictionary</span>

<span class="sd">        :return: a list with dictionary values</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_column</span></div>
    

<div class="viewcode-block" id="DataZip.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataZip.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;key_column&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the column of dataframe that will be values of dictionary&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;values_column&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the column of dataframe that will be keys of dictionary&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;the dataframe of columns will be extracted&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dictionary created by columns of a dataframe&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataZip.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataZip.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="DataZip.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataZip.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: with both columns indicates, create and returns a dictionary</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
        
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_key_column</span><span class="p">()</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_values_column</span><span class="p">()</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    
                    <span class="n">zip_list_object</span> <span class="o">=</span> <span class="n">ListZip</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_values_column</span><span class="p">()])</span>

                    <span class="k">return</span> <span class="n">zip_list_object</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_key_column</span><span class="p">()])</span>
                
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_values_column</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot; is not a column of the dataframe.&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_key_column</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot; is not a column of the dataframe.&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                                RENAME</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="RenameColumname"><a class="viewcode-back" href="../../src.html#src.processing.RenameColumname">[docs]</a><span class="k">class</span> <span class="nc">RenameColumname</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rename all names of the columns triping the name</span>
<span class="sd">        </span>
<span class="sd">    :param pos_ini: position of the first character</span>
<span class="sd">    :type pos_ini: int</span>
<span class="sd">    :param pos_fin: position of the last character</span>
<span class="sd">    :type pos_fin: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos_ini</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pos_fin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_ini</span> <span class="o">=</span> <span class="n">pos_ini</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_fin</span> <span class="o">=</span> <span class="n">pos_fin</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="RenameColumname.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RenameColumname.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pos_ini&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_ini</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pos_fin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_fin</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="RenameColumname.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RenameColumname.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pos_ini&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_fin</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pos_fin&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="RenameColumname.get_pos_ini"><a class="viewcode-back" href="../../src.html#src.processing.RenameColumname.get_pos_ini">[docs]</a>    <span class="k">def</span> <span class="nf">get_pos_ini</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the initial position with the first character</span>

<span class="sd">        :return: initial position</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_ini</span></div>

<div class="viewcode-block" id="RenameColumname.get_pos_fin"><a class="viewcode-back" href="../../src.html#src.processing.RenameColumname.get_pos_fin">[docs]</a>    <span class="k">def</span> <span class="nf">get_pos_fin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the last position with the first character</span>

<span class="sd">        :return: last position</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_fin</span></div>
    

<div class="viewcode-block" id="RenameColumname.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RenameColumname.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;pos_ini&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;initial position of name of the column&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;pos_fin&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;final position of name of the column&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe that rename its columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with columns renamed selecting a portion of the original name&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="RenameColumname.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RenameColumname.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    
    <span class="c1"># Do a substring from the sample id (column name), selecting an initial and a final position</span>
    <span class="c1"># The input parameter &quot;data&quot; can be the dataframe or the list of the columns directly</span>
<div class="viewcode-block" id="RenameColumname.apply"><a class="viewcode-back" href="../../src.html#src.processing.RenameColumname.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A DataFrame with the column renamed with a substring of the inner column name</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">dflist</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">dfilst</span> <span class="o">=</span> <span class="n">data</span>

    
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pos_ini</span><span class="p">(),</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pos_fin</span><span class="p">(),</span> <span class="nb">int</span><span class="p">):</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_ini</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_fin</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The position cannot be a negative number.&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_ini</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_fin</span><span class="p">():</span>                        			
    
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial position cannot be higher than final position.&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_fin</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">dflist</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final position cannot be higher than the length of the column name.&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_ini</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_fin</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial position cannot be the same as final position&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Positions must be integer.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dflist</span><span class="p">)):</span>
    
            <span class="n">dflist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dflist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pos_ini</span><span class="p">():</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pos_fin</span><span class="p">()]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">dflist</span>
    
        <span class="k">return</span> <span class="n">data</span></div></div>



<div class="viewcode-block" id="RenameIndex"><a class="viewcode-back" href="../../src.html#src.processing.RenameIndex">[docs]</a><span class="k">class</span> <span class="nc">RenameIndex</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rename the name of the current index of DataFrame</span>
<span class="sd">        </span>
<span class="sd">    :param new_name: name that will replace current one</span>
<span class="sd">    :type new_name: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_name</span> <span class="o">=</span> <span class="n">new_name</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="RenameIndex.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RenameIndex.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="RenameIndex.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RenameIndex.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;new_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="RenameIndex.get_new_name"><a class="viewcode-back" href="../../src.html#src.processing.RenameIndex.get_new_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_new_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new name</span>

<span class="sd">        :return: the new name</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_name</span></div>
    

<div class="viewcode-block" id="RenameIndex.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RenameIndex.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;new_name&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;new name of the dataframe index&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to rename its index&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with a renamed index&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="RenameIndex.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RenameIndex.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="RenameIndex.apply"><a class="viewcode-back" href="../../src.html#src.processing.RenameIndex.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: The same DataFrame with the index changed</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">(),</span> <span class="nb">str</span><span class="p">):</span>
             
            <span class="c1"># We extract the name of the index, because it will be</span>
            <span class="c1"># the name of the column in result</span>
            <span class="n">nm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="c1"># Remove the actual index</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            
            <span class="c1"># The new column after remove the index is the prior index,</span>
            <span class="c1"># but now we have the possibility of rename it</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">nm</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">()})</span>
            
            <span class="c1"># We set it as the new index again</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">())</span>
            
            <span class="k">return</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The new name must be a string.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                                DUPLICATES</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="DataDuplicates"><a class="viewcode-back" href="../../src.html#src.processing.DataDuplicates">[docs]</a><span class="k">class</span> <span class="nc">DataDuplicates</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a DataFrame with the duplicates rows or columns of a input DataFrame</span>
<span class="sd">        </span>
<span class="sd">    :param axis: axis 0 means by rows, 1 by columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param keep: Indicates which duplicates will keep</span>
<span class="sd">        \&quot;first\&quot; keeps only the first duplicated column/row; \&quot;last\&quot; keeps only the last duplicated column/row; False keeps both duplicated columns/rows</span>
<span class="sd">    :type keep: str, bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span> <span class="c1"># axis = 0 rows and axis = 1 columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DataDuplicates.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataDuplicates.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataDuplicates.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataDuplicates.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>
<div class="viewcode-block" id="DataDuplicates.get_axis"><a class="viewcode-back" href="../../src.html#src.processing.DataDuplicates.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to find duplicates</span>

<span class="sd">        :return: a number that could be 0 by rows and 1 by columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>
    
<div class="viewcode-block" id="DataDuplicates.get_keep"><a class="viewcode-back" href="../../src.html#src.processing.DataDuplicates.get_keep">[docs]</a>    <span class="k">def</span> <span class="nf">get_keep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which duplicates will keep</span>

<span class="sd">        :return: could be &quot;\&quot;first\&quot;, \&quot;last\&quot; or False</span>
<span class="sd">        :rtype: str, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span></div>
    

<div class="viewcode-block" id="DataDuplicates.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataDuplicates.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;axis&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;indicated 0 to row or 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;keep&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">first</span><span class="se">\&quot;</span><span class="s2"> keeps only the first duplicated column/row; </span><span class="se">\&quot;</span><span class="s2">last</span><span class="se">\&quot;</span><span class="s2"> keeps only the last duplicated column/row; False keeps both duplicated columns/rows&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to find duplicates&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe that only contains duplicated columns or rows&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DataDuplicates.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DataDuplicates.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="DataDuplicates.apply"><a class="viewcode-back" href="../../src.html#src.processing.DataDuplicates.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dataframe that only contains duplicated columns or rows</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># duplicated function looks for duplicated columns and generates a boolean matrix</span>
                    <span class="c1"># If keep == &quot;first&quot; -&gt; keeps only the first duplicated column</span>
                    <span class="c1"># If keep == &quot;last&quot; -&gt; keeps only the last duplicated column</span>
                    <span class="c1"># If keep = False -&gt; keeps both duplicated columns</span>
                    
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        
                        <span class="n">dup</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">())</span>
                        
                        <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">dup</span><span class="p">:</span> <span class="c1"># If a True value is on the dup list, there is (minimun) a duplicated row</span>
                            <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">dup</span><span class="p">]</span>
                        
                        <span class="k">else</span><span class="p">:</span>
                        
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There aren&#39;t duplicated variables&quot;</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                        
                    <span class="k">else</span><span class="p">:</span>
                    
                        <span class="n">dup</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">())</span>
                        
                        <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">dup</span><span class="p">:</span> <span class="c1"># If a True value is on the dup list, there is (minimun) a duplicated column</span>
                            
                            <span class="c1"># All rows, but only the True Columns</span>
                            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">dup</span><span class="p">]</span>
                
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There aren&#39;t duplicated variables&quot;</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Incorrect value of keep parameter. Options are: &quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\&quot;</span><span class="s2">first</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">last</span><span class="se">\&quot;</span><span class="s2"> or False&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    
            <span class="k">else</span><span class="p">:</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Incorrect parameter for axis. Options are: &quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">0 for rows, 1 for columns&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data must be a DataFrame&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                              INFORMATION</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="Describe"><a class="viewcode-back" href="../../src.html#src.processing.Describe">[docs]</a><span class="k">class</span> <span class="nc">Describe</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Show a statistic description about a DataFrame</span>
<span class="sd">        </span>
<span class="sd">    :param perc: The percentiles to include in the output</span>
<span class="sd">    :type perc: list, float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">perc</span> <span class="o">=</span> <span class="n">perc</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="Describe.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Describe.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;perc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perc</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="Describe.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Describe.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">perc</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;perc&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="Describe.get_percentiles"><a class="viewcode-back" href="../../src.html#src.processing.Describe.get_percentiles">[docs]</a>    <span class="k">def</span> <span class="nf">get_percentiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the percentil or list of percentil</span>

<span class="sd">        :return: percentil or list of percentils selected</span>
<span class="sd">        :rtype: list, float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perc</span></div>
    

<div class="viewcode-block" id="Describe.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.Describe.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;perc&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a float or list of float to indicates percentil&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to describe&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with result of describe&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="Describe.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.Describe.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Generate descriptive statistics that summarize the central tendency, dispersion and shape </span>
    <span class="c1"># of the dataset‚Äôs distribution, excluding NaN values.</span>
<div class="viewcode-block" id="Describe.apply"><a class="viewcode-back" href="../../src.html#src.processing.Describe.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: descriptive statistics that summarize the central tendency, dispersion and shape </span>
<span class="sd">        of the dataset‚Äôs distribution, excluding NaN values</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_percentiles</span><span class="p">())</span></div></div>



<div class="viewcode-block" id="CountTypes"><a class="viewcode-back" href="../../src.html#src.processing.CountTypes">[docs]</a><span class="k">class</span> <span class="nc">CountTypes</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Shows a Series containing counts of unique values of a specific column.</span>
<span class="sd">        It will be in descending order so that the first element is the most frequently-occurring element</span>
<span class="sd">        </span>
<span class="sd">    :param col_name: name of the column to count types</span>
<span class="sd">    :type col_name: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span> <span class="o">=</span> <span class="n">col_name</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CountTypes.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CountTypes.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CountTypes.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CountTypes.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="CountTypes.get_columname"><a class="viewcode-back" href="../../src.html#src.processing.CountTypes.get_columname">[docs]</a>    <span class="k">def</span> <span class="nf">get_columname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the column to count</span>

<span class="sd">        :return: name of the column</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span></div>
    

<div class="viewcode-block" id="CountTypes.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CountTypes.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;col_name&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the column to count its type&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to count types on a specific column&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;information about types of a column&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="CountTypes.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CountTypes.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="CountTypes.apply"><a class="viewcode-back" href="../../src.html#src.processing.CountTypes.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: information about types of a column</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_columname</span><span class="p">()</span> <span class="ow">in</span> <span class="n">DataColumnames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_columname</span><span class="p">()]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_columname</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;  is not a column name of data.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div></div>
        

        
<span class="c1"># =============================================================================</span>
<span class="c1">#                               REPLACE</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="Replace"><a class="viewcode-back" href="../../src.html#src.processing.Replace">[docs]</a><span class="k">class</span> <span class="nc">Replace</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace DataFrame&#39;s selected values with another.</span>

<span class="sd">    :param to_replace: values to be replaced</span>
<span class="sd">    :type to_replace: str, float, int, bool, list, ndarray</span>
<span class="sd">    :param replaced_by: new value to replaced the value before</span>
<span class="sd">    :type replaced_by: str, float, int, bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_replace</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">,</span> <span class="n">replaced_by</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span> <span class="o">=</span> <span class="n">to_replace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span> <span class="o">=</span> <span class="n">replaced_by</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="Replace.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Replace.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_replace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;replaced_by&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="Replace.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Replace.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_replace&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;replaced_by&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="Replace.get_to_replace"><a class="viewcode-back" href="../../src.html#src.processing.Replace.get_to_replace">[docs]</a>    <span class="k">def</span> <span class="nf">get_to_replace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value to search to replace</span>

<span class="sd">        :return: a value to be replace</span>
<span class="sd">        :rtype: str, float, int, bool, list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_replace</span></div>
    
<div class="viewcode-block" id="Replace.get_replaced_by"><a class="viewcode-back" href="../../src.html#src.processing.Replace.get_replaced_by">[docs]</a>    <span class="k">def</span> <span class="nf">get_replaced_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the new value</span>

<span class="sd">        :return: a value replace</span>
<span class="sd">        :rtype: str, float, int, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replaced_by</span></div>
    

<div class="viewcode-block" id="Replace.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.Replace.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;to_replace&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;values to be replaced&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;replaced_by&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;new value to replaced the value before&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to replace values&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with replaced values&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="Replace.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.Replace.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Replace all values by other value in a dataframe.</span>
    <span class="c1"># By default, it replaces all &quot;Unknown&quot;s by NAN,</span>
    <span class="c1"># but it is opened the possibility to let the user select both parameters.</span>
<div class="viewcode-block" id="Replace.apply"><a class="viewcode-back" href="../../src.html#src.processing.Replace.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame with all values indicates replaced by other value</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_replace</span><span class="p">(),</span> <span class="nb">list</span><span class="p">):</span>
            
            <span class="k">for</span> <span class="n">replac</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_to_replace</span><span class="p">():</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replac</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_replaced_by</span><span class="p">())</span>
                
            <span class="k">return</span> <span class="n">data</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_replace</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_replaced_by</span><span class="p">()))</span></div></div>



<div class="viewcode-block" id="FillNan"><a class="viewcode-back" href="../../src.html#src.processing.FillNan">[docs]</a><span class="k">class</span> <span class="nc">FillNan</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace nan values to mean of the row of DataFrame</span>
<span class="sd">        Only modifies values of DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="FillNan.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.FillNan.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="FillNan.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.FillNan.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="FillNan.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.FillNan.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame to replace nan values to mean&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame with nan replaced by mean&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="FillNan.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.FillNan.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>
    
    <span class="c1"># Execution</span>
    <span class="c1"># Replace all nan values to mean</span>
<div class="viewcode-block" id="FillNan.apply"><a class="viewcode-back" href="../../src.html#src.processing.FillNan.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A DataFrame with all nan values replace to mean</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">data_tmp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
       
        <span class="n">data_tmp</span> <span class="o">=</span> <span class="n">data_tmp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;list&quot;</span><span class="p">)</span>
        
        <span class="n">data_tmp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_tmp</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_tmp</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">data_tmp</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)]:</span>
            <span class="n">data_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">((</span><span class="n">data_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>

        <span class="n">data_tmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">DataColumnames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data_tmp</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                              TRANSPOSE</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="Transpose"><a class="viewcode-back" href="../../src.html#src.processing.Transpose">[docs]</a><span class="k">class</span> <span class="nc">Transpose</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Do transpose to a DataFrame keeping the name of columns and index</span>
<span class="sd">        without multi-index</span>
<span class="sd">            </span>
<span class="sd">    :param index_name: the name of the index before transpose to keep it</span>
<span class="sd">    :type index_name: str, int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span> <span class="o">=</span> <span class="n">index_name</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="Transpose.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Transpose.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="Transpose.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Transpose.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;index_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="Transpose.get_index_name"><a class="viewcode-back" href="../../src.html#src.processing.Transpose.get_index_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_index_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the current index name before transpose</span>

<span class="sd">        :return: name of the current index</span>
<span class="sd">        :rtype: str, int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span></div>
    
<div class="viewcode-block" id="Transpose.set_index_name"><a class="viewcode-back" href="../../src.html#src.processing.Transpose.set_index_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_index_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_name</span> <span class="o">=</span> <span class="n">new_name</span></div>
    

<div class="viewcode-block" id="Transpose.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.Transpose.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;index_name&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the index if exists&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to do a transpose&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a transpose of the dataframe&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="Transpose.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.Transpose.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Transpose of a dataframe taking into account the extra row</span>
    <span class="c1"># that it is created after the transpose: </span>
    <span class="c1"># https://stackoverflow.com/questions/38148877/how-to-remove-the-extra-row-or-column-after-transpose-in-pandas</span>
    <span class="c1"># TO DO: tener en cuenta de que puede ser una numpy matriz!!</span>
<div class="viewcode-block" id="Transpose.apply"><a class="viewcode-back" href="../../src.html#src.processing.Transpose.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame with transpose of the input taking into account the extra row that it is created after the transpose</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="c1"># If argument is empty, index_name will be the actual index of DataFrame</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">set_index_name</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="c1"># Remove the index</span>
        <span class="n">mod_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        
        <span class="c1"># If after doing the transpose there is an index, a dataframe is generated</span>
        <span class="c1"># with the index (for the rows) which is impossible to remove!!!</span>
        <span class="n">mod_transpose</span> <span class="o">=</span> <span class="n">mod_data</span><span class="o">.</span><span class="n">T</span>
        
        <span class="c1"># The first row will be the new index because the prior index (column 0)</span>
        <span class="c1"># it is now the row 0 (because of the transpose)</span>
        <span class="c1"># We keep it to change the column&#39;s names</span>
        <span class="n">row0</span> <span class="o">=</span> <span class="n">mod_transpose</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c1"># Row 0 is removed (selecting from row 1 to the rest of the rows)</span>
        <span class="n">mod_transpose</span> <span class="o">=</span> <span class="n">mod_transpose</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        
        <span class="c1"># After remove the index, it will appear an index by defualt whose values</span>
        <span class="c1"># moves from 0 to n_rows. After the transpose, this numbers will be the column&#39;s names</span>
        <span class="n">mod_transpose</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row0</span><span class="p">)</span>
        
        <span class="n">mod_transpose</span> <span class="o">=</span> <span class="n">mod_transpose</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        
        <span class="c1"># The name of the first column will be changed for the new that there was initially (nm_index)</span>
        <span class="c1"># so we rename the name of the first column</span>
        <span class="n">mod_data</span> <span class="o">=</span> <span class="n">mod_transpose</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">mod_transpose</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_name</span><span class="p">()})</span>

        <span class="c1"># We set the first column as the index</span>
        <span class="n">mod_data</span> <span class="o">=</span> <span class="n">mod_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index_name</span><span class="p">())</span>
        
    
        <span class="k">return</span> <span class="n">mod_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                                ADD</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="DataAdd"><a class="viewcode-back" href="../../src.html#src.processing.DataAdd">[docs]</a><span class="k">class</span> <span class="nc">DataAdd</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with add new element to DataFrame as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
<div class="viewcode-block" id="DataAdd.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataAdd.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>
<span class="sd">        </span>
<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataAdd.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataAdd.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="AddColumn"><a class="viewcode-back" href="../../src.html#src.processing.AddColumn">[docs]</a><span class="k">class</span> <span class="nc">AddColumn</span><span class="p">(</span><span class="n">DataAdd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add new column to a DataFrame</span>
<span class="sd">        </span>
<span class="sd">    :param name_column: Name of the new column</span>
<span class="sd">    :type name_column: str</span>
<span class="sd">    :param values: values of the new column. Must have the same lenght as number of rows of DataFrame</span>
<span class="sd">    :type values: list, ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_column</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span> <span class="o">=</span> <span class="n">name_column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="AddColumn.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.AddColumn.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="AddColumn.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.AddColumn.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name_column&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="AddColumn.get_name_column"><a class="viewcode-back" href="../../src.html#src.processing.AddColumn.get_name_column">[docs]</a>    <span class="k">def</span> <span class="nf">get_name_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the new column</span>

<span class="sd">        :return: Name of the new column</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_column</span></div>

<div class="viewcode-block" id="AddColumn.get_values"><a class="viewcode-back" href="../../src.html#src.processing.AddColumn.get_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of values to initialize the new column</span>

<span class="sd">        :return: A list with the values of new column</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span></div>
    

<div class="viewcode-block" id="AddColumn.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.AddColumn.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name_column&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the new column&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;values&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;values of the new column. Must have the same lenght as number of rows&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;new column with its values will be added to this dataframe&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with the new column&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="AddColumn.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.AddColumn.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Add a new column with its values to a DataFrame</span>
<div class="viewcode-block" id="AddColumn.apply"><a class="viewcode-back" href="../../src.html#src.processing.AddColumn.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: the input DataFrame with a new column with its values</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="c1"># Values must have the same items as number of rows to proceed to add a column</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>

            <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name_column</span><span class="p">()]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">data</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lenght of list of values must be the same as the row numbers of the DataFrame&quot;</span><span class="p">)</span>
            
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="AddLabel"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel">[docs]</a><span class="k">class</span> <span class="nc">AddLabel</span><span class="p">(</span><span class="n">DataAdd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a special column to a DataFrame.</span>
<span class="sd">        It will be used on Machine Learning as the Target Column of Classification</span>
<span class="sd">    </span>
<span class="sd">    :param list_0s: List of values that consider as 0 on Label value</span>
<span class="sd">    :type list_0s: list, ndarray</span>
<span class="sd">    :param column_observed: Column of the DataFrame used to decide when value of target is 0 or 1</span>
<span class="sd">    :type column_observed: str</span>
<span class="sd">    :param name_label: values of the new column. Must have the same lenght as number of rows of DataFrame</span>
<span class="sd">    :type name_label: list, ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_0s</span><span class="p">,</span> <span class="n">column_observed</span><span class="p">,</span> <span class="n">name_label</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_0s</span> <span class="o">=</span> <span class="n">list_0s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_observed</span> <span class="o">=</span> <span class="n">column_observed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_label</span> <span class="o">=</span> <span class="n">name_label</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="AddLabel.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;list_0s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_0s</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;column_observed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_observed</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_label</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="AddLabel.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_0s</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;list_0s&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_observed</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;column_observed&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_label</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;name_label&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="AddLabel.get_list_0s"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel.get_list_0s">[docs]</a>    <span class="k">def</span> <span class="nf">get_list_0s</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of values to consider as 0</span>

<span class="sd">        :return: List of values that consider as 0 on Label value</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_0s</span></div>

<div class="viewcode-block" id="AddLabel.get_column_observed"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel.get_column_observed">[docs]</a>    <span class="k">def</span> <span class="nf">get_column_observed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the target column</span>

<span class="sd">        :return: Name of the column to check to obtain label values</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_observed</span></div>

<div class="viewcode-block" id="AddLabel.get_name_label"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel.get_name_label">[docs]</a>    <span class="k">def</span> <span class="nf">get_name_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the target column</span>

<span class="sd">        :return: Name of the new column as target</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_label</span></div>
    

<div class="viewcode-block" id="AddLabel.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;list_0s&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;list of values that consider as 0 on Label value&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;column_observed&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the column to check to obtain label values&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;name_label&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the new column where labels were saved&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;the dataframe with the column to calculate labels values&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with the new column of labels added&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="AddLabel.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Add a new column that represents the labels of data to classify</span>
<div class="viewcode-block" id="AddLabel.apply"><a class="viewcode-back" href="../../src.html#src.processing.AddLabel.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame with a new column that represents the labels of data to classify</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">num_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

        <span class="n">datas_new_column</span> <span class="o">=</span> <span class="n">AddColumn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name_label</span><span class="p">(),</span> <span class="n">ut</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">mask_pathologic</span> <span class="o">=</span> <span class="n">datas_new_column</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column_observed</span><span class="p">()]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_list_0s</span><span class="p">())</span>

        <span class="n">datas_new_column</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask_pathologic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_name_label</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">datas_new_column</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                                DELETE</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="DataDrop"><a class="viewcode-back" href="../../src.html#src.processing.DataDrop">[docs]</a><span class="k">class</span> <span class="nc">DataDrop</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with Drop elements or values of a DataFrame as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
<div class="viewcode-block" id="DataDrop.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataDrop.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>
<span class="sd">        </span>
<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DataDrop.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DataDrop.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DropDuplicates"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates">[docs]</a><span class="k">class</span> <span class="nc">DropDuplicates</span><span class="p">(</span><span class="n">DataDrop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop data duplicates of a DataFrame</span>
<span class="sd">        </span>
<span class="sd">    :param axis: axis 0 means by rows, 1 by columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param keep: Indicates which duplicates will keep</span>
<span class="sd">        \&quot;first\&quot; keeps only the first duplicated column/row; \&quot;last\&quot; keeps only the last duplicated column/row; False keeps both duplicated columns/rows</span>
<span class="sd">    :type keep: str, bool</span>
<span class="sd">    :param by_name: True if only evaluate the name of the column/row, False if evaluate the content of the column/row to decide if is duplicated or not</span>
<span class="sd">    :type by_name: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">by_name</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span> <span class="c1"># axis = 0 rows and axis = 1 columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span> <span class="o">=</span> <span class="n">by_name</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DropDuplicates.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DropDuplicates.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by_name&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>
<div class="viewcode-block" id="DropDuplicates.get_axis"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to drop duplicates</span>

<span class="sd">        :return: a number that could be 0 by rows and 1 by columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>

<div class="viewcode-block" id="DropDuplicates.get_keep"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates.get_keep">[docs]</a>    <span class="k">def</span> <span class="nf">get_keep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which duplicates will keep</span>

<span class="sd">        :return: could be &quot;\&quot;first\&quot;, \&quot;last\&quot; or False</span>
<span class="sd">        :rtype: str, bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span></div>
    
<div class="viewcode-block" id="DropDuplicates.get_by_name"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates.get_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns which kind of evaluation will do to know if a row or column is duplicate or not</span>

<span class="sd">        :return: True if only search by row or column name, False if analyze value of row or column</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_name</span></div>
    

<div class="viewcode-block" id="DropDuplicates.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;axis&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;indicated 0 to row or 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;keep&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">first</span><span class="se">\&quot;</span><span class="s2"> keeps only the first duplicated column/row; </span><span class="se">\&quot;</span><span class="s2">last</span><span class="se">\&quot;</span><span class="s2"> keeps only the last duplicated column/row; False keeps both duplicated columns/rows&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;by_name&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;True if only evaluate the name of the column/row, False if evaluate the content of the column/row to decide if it is duplicated or not&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to drop duplicates rows or columns&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a new dataframe without duplicates rows or columns&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DropDuplicates.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="DropDuplicates.apply"><a class="viewcode-back" href="../../src.html#src.processing.DropDuplicates.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A new dataframe without duplicates rows or columns</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>


        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                        
                        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">())</span>
                    
                    <span class="k">else</span><span class="p">:</span>
                        
                        <span class="n">dup_rows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">())</span>
                        
                        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">dup_rows</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span> <span class="c1"># axis == 1 then, columns</span>
                
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>

                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">()</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
    
                            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">())]</span>
                
                        <span class="k">else</span><span class="p">:</span>
                
                            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
                    <span class="k">else</span><span class="p">:</span>
                        
                        <span class="n">dup_cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keep</span><span class="p">())</span>

                        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="o">~</span><span class="n">dup_cols</span><span class="p">]</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Incorrect value of keep parameter. Options are: &quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\&quot;</span><span class="s2">first</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">last</span><span class="se">\&quot;</span><span class="s2"> or False&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Incorrect parameter for axis. Options are: &quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">0 for rows, 1 for columns&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DropValues"><a class="viewcode-back" href="../../src.html#src.processing.DropValues">[docs]</a><span class="k">class</span> <span class="nc">DropValues</span><span class="p">(</span><span class="n">DataDrop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop values of a DataFrame</span>

<span class="sd">    :param to_delete: value to be delete.</span>
<span class="sd">    :type to_delete: str, float, int, bool, list, ndarray, </span>
<span class="sd">    :param axis: Indicates 0 to row and 1 to columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param method: all to check all values are the same, any if a partial value match</span>
<span class="sd">    :type method: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">=</span> <span class="n">to_delete</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DropValues.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DropValues.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_delete&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DropValues.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DropValues.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_delete&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>

<div class="viewcode-block" id="DropValues.get_to_delete"><a class="viewcode-back" href="../../src.html#src.processing.DropValues.get_to_delete">[docs]</a>    <span class="k">def</span> <span class="nf">get_to_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value to be delete</span>

<span class="sd">        :return: value to be delete</span>
<span class="sd">        :rtype: str, float, int, bool, list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span></div>
    
<div class="viewcode-block" id="DropValues.get_axis"><a class="viewcode-back" href="../../src.html#src.processing.DropValues.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to search value</span>

<span class="sd">        :return: 0 to row and 1 to columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>
    
<div class="viewcode-block" id="DropValues.get_method"><a class="viewcode-back" href="../../src.html#src.processing.DropValues.get_method">[docs]</a>    <span class="k">def</span> <span class="nf">get_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the method to check if value should be delete</span>

<span class="sd">        :return: all to check all values are the same, any if a partial value match</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span></div>
    

<div class="viewcode-block" id="DropValues.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DropValues.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;to_delete&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;value to be delete&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;axis&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Indicates 0 to row and 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;method&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;all to check all values are the same, any if a partial value match&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to drop some values&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a new dataframe within this values&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DropValues.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DropValues.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="DropValues.apply"><a class="viewcode-back" href="../../src.html#src.processing.DropValues.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A new dataframe within this values</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_method</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_delete</span><span class="p">()])</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">())]</span>
                
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_method</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;any&quot;</span><span class="p">:</span>
                
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_delete</span><span class="p">()])</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">())]</span>
            
            <span class="k">return</span> <span class="n">data</span>
        
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameter to delete not found.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DropNanByThresh"><a class="viewcode-back" href="../../src.html#src.processing.DropNanByThresh">[docs]</a><span class="k">class</span> <span class="nc">DropNanByThresh</span><span class="p">(</span><span class="n">DataDrop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop DataFrame&#39;s values limited by Threshold.</span>

<span class="sd">    :param axis: Indicates 0 to row and 1 to columns</span>
<span class="sd">    :type axis: int</span>
<span class="sd">    :param thresh: threshold to evaluate element. If value less than threshold, that will be selected to drop</span>
<span class="sd">    :type thresh: float, int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">thresh</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DropNanByThresh.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DropNanByThresh.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DropNanByThresh.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DropNanByThresh.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thresh&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>
    
<div class="viewcode-block" id="DropNanByThresh.get_axis"><a class="viewcode-back" href="../../src.html#src.processing.DropNanByThresh.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the axis selected to search value</span>

<span class="sd">        :return: 0 to row and 1 to columns</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span></div>
    
<div class="viewcode-block" id="DropNanByThresh.get_thresh"><a class="viewcode-back" href="../../src.html#src.processing.DropNanByThresh.get_thresh">[docs]</a>    <span class="k">def</span> <span class="nf">get_thresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the threshold to evaluate element</span>

<span class="sd">        :return: If value less than it, that will be selected to drop</span>
<span class="sd">        :rtype: float, int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span></div>
    

<div class="viewcode-block" id="DropNanByThresh.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DropNanByThresh.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;axis&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;indicates 0 to rows or 1 to columns&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;thresh&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;threshold to evaluate element. If value less than threshold, that will be selected to drop&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to drop values&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with drop element checking a threshold&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DropNanByThresh.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DropNanByThresh.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="DropNanByThresh.apply"><a class="viewcode-back" href="../../src.html#src.processing.DropNanByThresh.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dataframe with drop element checking a threshold</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(),</span> <span class="n">thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">())</span>
            
            <span class="k">return</span> <span class="n">data</span>
        
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error with the parameters.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DropRowsByColname"><a class="viewcode-back" href="../../src.html#src.processing.DropRowsByColname">[docs]</a><span class="k">class</span> <span class="nc">DropRowsByColname</span><span class="p">(</span><span class="n">DataDrop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop DataFrame&#39;s rows searching a value on a specific column</span>

<span class="sd">    :param col_name: name of the column to search</span>
<span class="sd">    :type col_name: str</span>
<span class="sd">    :param to_delete: value to find on a column to decide with row delete is exists</span>
<span class="sd">    :type to_delete: str, float, int, bool, list, ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">to_delete</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span> <span class="o">=</span> <span class="n">col_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">=</span> <span class="n">to_delete</span>


    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="DropRowsByColname.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DropRowsByColname.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_delete&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="DropRowsByColname.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.DropRowsByColname.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;col_name&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;to_delete&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>
    
<div class="viewcode-block" id="DropRowsByColname.get_columname"><a class="viewcode-back" href="../../src.html#src.processing.DropRowsByColname.get_columname">[docs]</a>    <span class="k">def</span> <span class="nf">get_columname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns name of the column to search values to delete</span>

<span class="sd">        :return: name of the specific column</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span></div>

<div class="viewcode-block" id="DropRowsByColname.get_to_delete"><a class="viewcode-back" href="../../src.html#src.processing.DropRowsByColname.get_to_delete">[docs]</a>    <span class="k">def</span> <span class="nf">get_to_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns value search and delete</span>

<span class="sd">        :return: value to search</span>
<span class="sd">        :rtype: str, float, int, bool, list, ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span></div>
    

<div class="viewcode-block" id="DropRowsByColname.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DropRowsByColname.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;col_name&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the column to search values to delete&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;to_delete&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;value to be search and delete&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to drop rows&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with dropped rows after search a value on a specific column&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DropRowsByColname.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.DropRowsByColname.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="DropRowsByColname.apply"><a class="viewcode-back" href="../../src.html#src.processing.DropRowsByColname.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dataframe with dropped rows search a value on a specific column</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_columname</span><span class="p">()</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_to_delete</span><span class="p">(),</span> <span class="nb">list</span><span class="p">):</span>
                
                <span class="k">for</span> <span class="n">delet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_to_delete</span><span class="p">():</span>
                    
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_columname</span><span class="p">()]</span> <span class="o">!=</span> <span class="n">delet</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_columname</span><span class="p">()]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_to_delete</span><span class="p">()]</span>

            <span class="k">return</span> <span class="n">data</span>
                    
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_columname</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot; column does not exist in the dataframe&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">######################################################</span>

<span class="sd">                QUANTITATIVE ANALYSIS</span>

<span class="sd">######################################################</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="QuantAnalysis"><a class="viewcode-back" href="../../src.html#src.processing.QuantAnalysis">[docs]</a><span class="k">class</span> <span class="nc">QuantAnalysis</span><span class="p">(</span><span class="n">DataTask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with Quantitative Analysis of a DataFrame as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
<div class="viewcode-block" id="QuantAnalysis.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.QuantAnalysis.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>
<span class="sd">        </span>
<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="QuantAnalysis.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.QuantAnalysis.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                              CORRELATION</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="VarCorrelation"><a class="viewcode-back" href="../../src.html#src.processing.VarCorrelation">[docs]</a><span class="k">class</span> <span class="nc">VarCorrelation</span><span class="p">(</span><span class="n">QuantAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates correlation between variables of a DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="VarCorrelation.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.VarCorrelation.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>
    
<div class="viewcode-block" id="VarCorrelation.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.VarCorrelation.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="VarCorrelation.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.VarCorrelation.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to do a correlation&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with the correlation done&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="VarCorrelation.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.VarCorrelation.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># Creates a dataframe with the correlation between the variables</span>
    <span class="c1"># with values from 0.0 to 1.0, being 1.0 the highest value of correlation</span>
<div class="viewcode-block" id="VarCorrelation.apply"><a class="viewcode-back" href="../../src.html#src.processing.VarCorrelation.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dataframe with the correlation between the variables</span>
<span class="sd">            with values from 0.0 to 1.0, being 1.0 the highest value of correlation</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span></div></div>



<div class="viewcode-block" id="RemoveCorrelation"><a class="viewcode-back" href="../../src.html#src.processing.RemoveCorrelation">[docs]</a><span class="k">class</span> <span class="nc">RemoveCorrelation</span><span class="p">(</span><span class="n">QuantAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove the elements that has high correlation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thresh</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">thresh</span>


    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="RemoveCorrelation.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RemoveCorrelation.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="RemoveCorrelation.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RemoveCorrelation.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thresh&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>
    
<div class="viewcode-block" id="RemoveCorrelation.get_thresh"><a class="viewcode-back" href="../../src.html#src.processing.RemoveCorrelation.get_thresh">[docs]</a>    <span class="k">def</span> <span class="nf">get_thresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the limit used to decide with elements remove</span>
<span class="sd">        </span>
<span class="sd">        :return: a threshold value</span>
<span class="sd">        :rtype: float, int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span></div>
    

<div class="viewcode-block" id="RemoveCorrelation.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RemoveCorrelation.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;thresh&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;threshold to select values higher than this&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to delete high correlation&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with high correlation drop&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="RemoveCorrelation.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RemoveCorrelation.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="RemoveCorrelation.apply"><a class="viewcode-back" href="../../src.html#src.processing.RemoveCorrelation.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dataframe with high correlation removed</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            
            <span class="n">data_tmp</span> <span class="o">=</span> <span class="n">Transpose</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            
            <span class="n">remove</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">corr</span> <span class="o">=</span> <span class="n">VarCorrelation</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data_tmp</span><span class="p">)</span>
        
            <span class="n">corr_high</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">()</span>

            <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">corr_high</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_high</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
                    
                    <span class="n">j</span> <span class="o">=</span> <span class="n">corr_high</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                       
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">corr_high</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">):</span>
                            
                            <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">remove</span><span class="p">:</span>
                                <span class="n">remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
                                
                <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
        
            <span class="n">remove</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">remove</span><span class="p">))</span>
        
            <span class="c1">#delete the elements that has high correlation</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data_tmp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">remove</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">data</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                               VARIANCE</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="Variance"><a class="viewcode-back" href="../../src.html#src.processing.Variance">[docs]</a><span class="k">class</span> <span class="nc">Variance</span><span class="p">(</span><span class="n">QuantAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the variance of a matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="Variance.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Variance.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="Variance.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Variance.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="Variance.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.Variance.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to calculate its variance&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dictionary with the variance of each gene&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="Variance.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.Variance.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="Variance.apply"><a class="viewcode-back" href="../../src.html#src.processing.Variance.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dictionary with the variance of each variable</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">ListZip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">var</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">var</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                              SELECTION</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="TopVariables"><a class="viewcode-back" href="../../src.html#src.processing.TopVariables">[docs]</a><span class="k">class</span> <span class="nc">TopVariables</span><span class="p">(</span><span class="n">QuantAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the best n variables of a DataFrame</span>

<span class="sd">    :param n_var: Number of variables selected as the best</span>
<span class="sd">    :type n_var: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_var</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_var</span> <span class="o">=</span> <span class="n">n_var</span>


    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="TopVariables.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.TopVariables.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;n_var&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_var</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="TopVariables.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.TopVariables.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_var</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;n_var&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>
    
<div class="viewcode-block" id="TopVariables.get_num_var"><a class="viewcode-back" href="../../src.html#src.processing.TopVariables.get_num_var">[docs]</a>    <span class="k">def</span> <span class="nf">get_num_var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns how many variables will be returned</span>

<span class="sd">        :return: Number of variables selected as the best</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_var</span></div>
    

<div class="viewcode-block" id="TopVariables.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.TopVariables.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;n_var&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;number of variables to save&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a data structure to search the best n_var variables to select&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with n_var rows that are the best&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="TopVariables.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.TopVariables.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
<div class="viewcode-block" id="TopVariables.apply"><a class="viewcode-back" href="../../src.html#src.processing.TopVariables.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dataframe with n_var rows that are the best</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            
            <span class="c1"># Comprobar que n_var no sea mayor al numero total de variables,</span>
            <span class="c1"># y que sea &gt; que 0</span>
            
            <span class="n">variables</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_num_var</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">variables</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
            <span class="c1"># Choose n_var more expressed in data</span>
            <span class="n">select_var</span> <span class="o">=</span>  <span class="n">variables</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">get_num_var</span><span class="p">()]</span>
        
            <span class="n">highest_vars</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">select_var</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            
            <span class="k">return</span> <span class="n">highest_vars</span> 
        
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            
            <span class="n">var_sort</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Find top 1000 genes</span>
            <span class="n">top_var</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">var_sort</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">]]</span>
            
            <span class="k">return</span> <span class="n">top_var</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input data must be a dataframe or dictionary&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="RemoveLowReads"><a class="viewcode-back" href="../../src.html#src.processing.RemoveLowReads">[docs]</a><span class="k">class</span> <span class="nc">RemoveLowReads</span><span class="p">(</span><span class="n">QuantAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the best n variables of a DataFrame</span>

<span class="sd">    :param thresh: threshold that indicates the limit to remove feature less than it</span>
<span class="sd">    :type thresh: float</span>
<span class="sd">    :param at_least: Indicates the minimum match to pass the selection</span>
<span class="sd">    :type at_least: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">at_least</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">thresh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">at_least</span> <span class="o">=</span> <span class="n">at_least</span>


    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="RemoveLowReads.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RemoveLowReads.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;at_least&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_least</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="RemoveLowReads.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RemoveLowReads.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thresh&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">at_least</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;at_least&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getters</span>
    
<div class="viewcode-block" id="RemoveLowReads.get_thresh"><a class="viewcode-back" href="../../src.html#src.processing.RemoveLowReads.get_thresh">[docs]</a>    <span class="k">def</span> <span class="nf">get_thresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the threshold that limits to remove feature less than it</span>

<span class="sd">        :return: the Threshold</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span></div>
    
<div class="viewcode-block" id="RemoveLowReads.get_at_least"><a class="viewcode-back" href="../../src.html#src.processing.RemoveLowReads.get_at_least">[docs]</a>    <span class="k">def</span> <span class="nf">get_at_least</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the minimum match to pass the selection</span>

<span class="sd">        :return: the minimum match to pass</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_least</span></div>


<div class="viewcode-block" id="RemoveLowReads.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RemoveLowReads.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;thresh&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;threshold that indicates the limit to remove feature less than it&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;at_least&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Indicates the minimum match to pass the selection&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to remove features by threshold condition&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with less reads removed&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="RemoveLowReads.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RemoveLowReads.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Execution</span>
    <span class="c1"># See from RNAlysis: https://guyteichman.github.io/RNAlysis/build/rnalysis.filtering.CountFilter.filter_low_reads.html</span>
    <span class="c1"># Remove features which have less then ‚Äòthreshold‚Äô reads all columns</span>
<div class="viewcode-block" id="RemoveLowReads.apply"><a class="viewcode-back" href="../../src.html#src.processing.RemoveLowReads.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dataframe with removed features which have less then ‚Äòthreshold‚Äô reads all columns</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">thresh_filter</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">()</span>

        <span class="c1"># By Columns (Up to Down)</span>
        <span class="n">thresh_at</span> <span class="o">=</span> <span class="n">thresh_filter</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_at_least</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">thresh_at</span><span class="p">]</span></div></div>



<span class="c1"># =============================================================================</span>
<span class="c1">#                              NORMALIZATION</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="Normalization"><a class="viewcode-back" href="../../src.html#src.processing.Normalization">[docs]</a><span class="k">class</span> <span class="nc">Normalization</span><span class="p">(</span><span class="n">QuantAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with Normalization of a DataFrame as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
<div class="viewcode-block" id="Normalization.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Normalization.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>
<span class="sd">        </span>
<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="Normalization.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.Normalization.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CPM"><a class="viewcode-back" href="../../src.html#src.processing.CPM">[docs]</a><span class="k">class</span> <span class="nc">CPM</span><span class="p">(</span><span class="n">Normalization</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Normalize values of DataFrame using CPM method</span>
<span class="sd">        </span>
<span class="sd">    :param log_method: True if CPM will do with logaritmic alghoritm, False otherwise</span>
<span class="sd">    :type log_method: bool</span>
<span class="sd">    :param prior_count: If log is True, ends up getting scaled by the ratio of a library size to the average library size and then multiplied by its value before getting added to each library size</span>
<span class="sd">    :type prior_count: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_method</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">prior_count</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_method</span> <span class="o">=</span> <span class="n">log_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prior_count</span> <span class="o">=</span> <span class="n">prior_count</span>
        
    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="CPM.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CPM.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;log_method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_method</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;prior_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prior_count</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="CPM.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.CPM.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_method</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;log_method&#39;</span><span class="p">]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">prior_count</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;prior_count&#39;</span><span class="p">]</span> </div>
    
<div class="viewcode-block" id="CPM.get_log_method"><a class="viewcode-back" href="../../src.html#src.processing.CPM.get_log_method">[docs]</a>    <span class="k">def</span> <span class="nf">get_log_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns if CPM will be apply with logaritmic or not</span>

<span class="sd">        :return: True if CPM will do with logaritmic alghoritm, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_method</span></div>
    
<div class="viewcode-block" id="CPM.get_prior_count"><a class="viewcode-back" href="../../src.html#src.processing.CPM.get_prior_count">[docs]</a>    <span class="k">def</span> <span class="nf">get_prior_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the ratio of a library size to the average library size</span>

<span class="sd">        :return: the ratio of a library size to the average library size</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prior_count</span></div>
    

<div class="viewcode-block" id="CPM.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CPM.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;log_method&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;True if CPM will do with logaritmic alghoritm, False otherwise&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;prior_count&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;If log_method is True, ends up getting scaled by the ratio of a library size to the average library size and then multiplied by its value before getting added to each library size&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe to normalize&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a normalized dataframe by one of two options&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="CPM.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.CPM.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


    <span class="c1"># Calculate the Counts per million (CPM) of the counts</span>
    <span class="c1"># RPM or CPM = (Number of reads mapped to gene x 10^6) / Total number of mapped reads    </span>
<div class="viewcode-block" id="CPM.cpm_"><a class="viewcode-back" href="../../src.html#src.processing.CPM.cpm_">[docs]</a>    <span class="k">def</span> <span class="nf">cpm_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the Counts per million (CPM) of the counts</span>

<span class="sd">        :param data: a DataFrame for which normalization is computed.</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame with CPM computed</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># The method should work both with a dataframe or a numpy array</span>
        <span class="c1"># https://www.w3schools.com/python/ref_func_isinstance.asp</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1"># Gene counts must be non-negative</span>
            <span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.0</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Convert into numpy array</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="c1"># Gene counts must be non-negative</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.0</span>  
    
        <span class="n">data_sum</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
        <span class="c1"># Ignore warnings of division by 0</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
            <span class="n">cpm_value</span> <span class="o">=</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="n">data</span> <span class="o">/</span> <span class="n">data_sum</span>
    
            <span class="c1"># The samples with zeros for all genes get nan but should be 0.0</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">cpm_value</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
        <span class="k">return</span> <span class="n">cpm_value</span></div>
    
    <span class="c1"># Calculate the Log CPM of the counts</span>
    <span class="c1"># https://bioinformatics.stackexchange.com/questions/4985/how-is-prior-count-used-by-edgers-cpm#:~:text=edgeR&#39;s%20cpm%20function%20has%20an,would%20be%20equal%20to%20prior.   </span>
<div class="viewcode-block" id="CPM.cpm_log"><a class="viewcode-back" href="../../src.html#src.processing.CPM.cpm_log">[docs]</a>    <span class="k">def</span> <span class="nf">cpm_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the Log CPM of the counts</span>

<span class="sd">        :param data: a DataFrame for which normalization is computed.</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame with CPM Log computed</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># The method should work both with a dataframe or a numpy array</span>
        <span class="c1"># https://www.w3schools.com/python/ref_func_isinstance.asp</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1"># Gene counts must be non-negative</span>
            <span class="c1"># data = data.astype(np.float)</span>
            <span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.0</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Convert into numpy array</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="c1"># Gene counts must be non-negative</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.0</span>  
    
        <span class="c1"># First, we need to calculate a library size</span>
        <span class="n">lib_size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># Calculate the average library size and the adjusted priors</span>
        <span class="n">ave_lib</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lib_size</span><span class="p">)</span>
        <span class="n">adjusted_prior</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_prior_count</span><span class="p">()</span> <span class="o">*</span> <span class="n">lib_size</span> <span class="o">/</span> <span class="n">ave_lib</span>
        
        <span class="c1"># Update the library sizes</span>
        <span class="n">adjusted_lib_size</span> <span class="o">=</span> <span class="n">lib_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">adjusted_prior</span>
        
        <span class="c1"># Now we can compute the CPM</span>
        <span class="n">customCPM</span> <span class="o">=</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">adjusted_prior</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">adjusted_lib_size</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1000000</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">customCPM</span> </div>

    <span class="c1"># Execution</span>

<div class="viewcode-block" id="CPM.apply"><a class="viewcode-back" href="../../src.html#src.processing.CPM.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame to computed one of the CPM method</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_log_method</span><span class="p">():</span> 
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpm_log</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpm_</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div></div>




<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">######################################################</span>

<span class="sd">                    RNA PROCESS</span>

<span class="sd">######################################################</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="GeneAnalysis"><a class="viewcode-back" href="../../src.html#src.processing.GeneAnalysis">[docs]</a><span class="k">class</span> <span class="nc">GeneAnalysis</span><span class="p">(</span><span class="n">QuantAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a conceptual class representation that organize</span>
<span class="sd">        all method associate with Gene Analysis of a DataFrame as Task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
<div class="viewcode-block" id="GeneAnalysis.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.GeneAnalysis.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>
<span class="sd">        </span>
<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="GeneAnalysis.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.GeneAnalysis.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="SampleCondition"><a class="viewcode-back" href="../../src.html#src.processing.SampleCondition">[docs]</a><span class="k">class</span> <span class="nc">SampleCondition</span><span class="p">(</span><span class="n">GeneAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Classify a given sample analyze its barcode</span>

<span class="sd">    :param sep: indicates with character is used to separate values</span>
<span class="sd">    :type sep: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="o">=</span> <span class="n">sep</span>
        
    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="SampleCondition.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.SampleCondition.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;separator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>

        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="SampleCondition.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.SampleCondition.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;separator&#39;</span><span class="p">]</span> </div>

    <span class="c1"># Getter</span>

<div class="viewcode-block" id="SampleCondition.get_separator"><a class="viewcode-back" href="../../src.html#src.processing.SampleCondition.get_separator">[docs]</a>    <span class="k">def</span> <span class="nf">get_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the character used to separate the name of the barcode</span>

<span class="sd">        :return: character to separate barcode on segment</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span></div>


<div class="viewcode-block" id="SampleCondition.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.SampleCondition.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;sep&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;indicates with character is used to separate values&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;brc_string&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a string that contains information about a tumor&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;classification of this sample&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="SampleCondition.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.SampleCondition.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


<div class="viewcode-block" id="SampleCondition.apply"><a class="viewcode-back" href="../../src.html#src.processing.SampleCondition.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brc_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param brc_string: The current str to be process</span>
<span class="sd">        :type brc_string: str</span>
<span class="sd">        :return: classification of the sample by its barcode passed on input</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">brc_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                
        <span class="c1"># brc_example = &quot;TCGA-02-0001-01C-01D-0182-01&quot;</span>
        <span class="c1">#                  0  1   2   3    4   5   6</span>
        <span class="n">brc_sample__vial</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#num-letra =&gt; 01C ; num(sample) letra(vial)</span>
    
        <span class="n">brc_splited</span> <span class="o">=</span> <span class="n">brc_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">())</span>
    
        <span class="n">sample_vial</span> <span class="o">=</span> <span class="n">brc_splited</span><span class="p">[</span><span class="n">brc_sample__vial</span><span class="p">]</span> <span class="c1"># String, array de char [&quot;0&quot;, &quot;1&quot;, &quot;C&quot;]</span>
    
        <span class="n">sample_</span> <span class="o">=</span> <span class="n">sample_vial</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> 
        <span class="c1">#vial_ = sample_vial[-1] # String, array de char [&quot;0&quot;, &quot;1&quot;, &quot;C&quot;]</span>
    
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sample_type</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_</span><span class="p">)</span>
    
            <span class="k">if</span> <span class="n">sample_type</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sample_type</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;TUMR&quot;</span> <span class="c1"># tumor sample</span>
            
            <span class="k">elif</span> <span class="n">sample_type</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">sample_type</span> <span class="o">&lt;=</span> <span class="mi">19</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;NORM&quot;</span> <span class="c1"># normal sample</span>
            
            <span class="k">elif</span> <span class="n">sample_type</span> <span class="o">&gt;=</span> <span class="mi">20</span> <span class="ow">and</span> <span class="n">sample_type</span> <span class="o">&lt;=</span> <span class="mi">29</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;CTRL&quot;</span> <span class="c1"># control sample</span>
    
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to stablished the type of sample&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;NAN&quot;</span>
    
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to stablished the type of sample&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;NAN&quot;</span></div></div>



<div class="viewcode-block" id="StatTest"><a class="viewcode-back" href="../../src.html#src.processing.StatTest">[docs]</a><span class="k">class</span> <span class="nc">StatTest</span><span class="p">(</span><span class="n">GeneAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a DataFrame with several statistic information like FoldChange, T, P-Value and a DiffExpr</span>

<span class="sd">    :param grouped_by: name of the column of clinical data to organize data</span>
<span class="sd">    :type grouped_by: str</span>
<span class="sd">    :param group_1: one of the type to create a group</span>
<span class="sd">    :type group_1: str</span>
<span class="sd">    :param group_2: another type to create a group</span>
<span class="sd">    :type group_2: str</span>
<span class="sd">    :param clinical_data: a dataframe with clinical information of the data</span>
<span class="sd">    :type clinical_data: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grouped_by</span><span class="p">,</span> <span class="n">group_1</span><span class="p">,</span> <span class="n">group_2</span><span class="p">,</span> <span class="n">clinical_data</span><span class="p">):</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Input Parameters&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grouped_by</span> <span class="o">=</span> <span class="n">grouped_by</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_1</span> <span class="o">=</span> <span class="n">group_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_2</span> <span class="o">=</span> <span class="n">group_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clinical_data</span> <span class="o">=</span> <span class="n">clinical_data</span>
        
    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="StatTest.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;grouped_by&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouped_by</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;group_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_1</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;group_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_2</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;clinical_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clinical_data</span>

        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="StatTest.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grouped_by</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;grouped_by&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;group_1&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_2</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;group_2&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clinical_data</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;clinical_data&#39;</span><span class="p">]</span></div>

    <span class="c1"># Getter</span>
    
<div class="viewcode-block" id="StatTest.get_grouped_by"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.get_grouped_by">[docs]</a>    <span class="k">def</span> <span class="nf">get_grouped_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns name of the column of clinical data to organize data</span>

<span class="sd">        :return: name of the column to organize</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouped_by</span></div>

<div class="viewcode-block" id="StatTest.get_group_1"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.get_group_1">[docs]</a>    <span class="k">def</span> <span class="nf">get_group_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns one of the type to create a group</span>

<span class="sd">        :return: one of the type</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_1</span></div>

<div class="viewcode-block" id="StatTest.get_group_2"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.get_group_2">[docs]</a>    <span class="k">def</span> <span class="nf">get_group_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns another type to create a group</span>

<span class="sd">        :return: another type</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_2</span></div>

<div class="viewcode-block" id="StatTest.get_clinical_data"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.get_clinical_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_clinical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dataframe with clinical information of the data</span>

<span class="sd">        :return: a DataFrame with clinical data</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clinical_data</span></div>


<div class="viewcode-block" id="StatTest.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;grouped_by&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;name of the column of clinical data to organize data&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;group_1&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;one of the type to create a group&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;group_2&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;another type to create a group&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;clinical_data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with clinical information of the data&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with the count matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with several stadistic information: FoldChange, T, P-Value and a DiffExpr&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="StatTest.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


<div class="viewcode-block" id="StatTest.apply"><a class="viewcode-back" href="../../src.html#src.processing.StatTest.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: A dataframe with several stadistic information: FoldChange, T, P-Value and a DiffExpr</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
                
        <span class="c1"># All Columns of Clinical Information</span>
        <span class="n">columns_clinical</span> <span class="o">=</span> <span class="n">DataColumnames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clinical_data</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_grouped_by</span><span class="p">()</span> <span class="ow">in</span> <span class="n">columns_clinical</span><span class="p">:</span>
            
            <span class="c1"># Get elements of group 1</span>
            <span class="n">sample_by_group_1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clinical_data</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clinical_data</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_grouped_by</span><span class="p">()]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group_1</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

            <span class="c1"># Get elements of group 2</span>
            <span class="n">sample_by_group_2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clinical_data</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clinical_data</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_grouped_by</span><span class="p">()]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group_2</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

            <span class="c1"># Get counts by condition of group 1</span>
            <span class="n">proc_group_1</span> <span class="o">=</span> <span class="n">DataProjectionList</span><span class="p">(</span><span class="n">sample_by_group_1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="c1"># Get counts by condition of group 2</span>
            <span class="n">proc_group_2</span> <span class="o">=</span> <span class="n">DataProjectionList</span><span class="p">(</span><span class="n">sample_by_group_2</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


            <span class="k">if</span> <span class="ow">not</span> <span class="n">proc_group_1</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">proc_group_2</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                
                <span class="c1"># Get means of group 1 of every row</span>

                <span class="n">group_1_means</span> <span class="o">=</span> <span class="n">proc_group_1</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Get means of group 2 of every row</span>
                
                <span class="n">group_2_means</span> <span class="o">=</span> <span class="n">proc_group_2</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Get foldchanges</span>
                <span class="n">foldchanges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">group_1_means</span><span class="p">,</span> <span class="n">group_2_means</span><span class="p">)))</span>

                <span class="c1"># Get P-Value</span>
                <span class="n">p_values</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">t_test</span> <span class="o">=</span> <span class="p">[]</span>
                
                <span class="n">indx_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
                <span class="n">index_df</span> <span class="o">=</span> <span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">index_df</span><span class="p">:</span>
                    <span class="c1"># avoid warning divide by zero (they will be Zero)</span>
                    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
                        <span class="n">ttest_result</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">proc_group_1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:],</span>  <span class="n">proc_group_2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:])</span>
                        <span class="n">p_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ttest_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">t_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ttest_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


                <span class="n">transformed_pvals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p_values</span><span class="p">))</span>

                <span class="c1"># Create a dataframe with data calculated</span>
                <span class="n">pdict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">indx_name</span> <span class="p">:</span> <span class="n">index_df</span>
                <span class="p">}</span>

                <span class="n">df_stat_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pdict</span><span class="p">)</span>

                <span class="n">df_stat_test</span> <span class="o">=</span> <span class="n">df_stat_test</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">indx_name</span><span class="p">)</span>

                <span class="n">df_stat_test</span> <span class="o">=</span> <span class="n">AddColumn</span><span class="p">(</span><span class="s2">&quot;FoldChange&quot;</span><span class="p">,</span> <span class="n">foldchanges</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df_stat_test</span><span class="p">)</span>

                <span class="n">df_stat_test</span> <span class="o">=</span> <span class="n">AddColumn</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">t_test</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df_stat_test</span><span class="p">)</span>

                <span class="n">df_stat_test</span> <span class="o">=</span> <span class="n">AddColumn</span><span class="p">(</span><span class="s2">&quot;P-Value&quot;</span><span class="p">,</span> <span class="n">transformed_pvals</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df_stat_test</span><span class="p">)</span>

                <span class="n">df_stat_test</span> <span class="o">=</span> <span class="n">AddColumn</span><span class="p">(</span><span class="s2">&quot;DiffExpr&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">df_stat_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df_stat_test</span><span class="p">)</span>

                <span class="c1">#assign each point on the plot a color based on its coordinates</span>
                <span class="c1">#points that are in the top right or top left should be highlighted </span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_stat_test</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;P-Value&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    
                        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;FoldChange&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                            <span class="n">df_stat_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;DiffExpr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Up&quot;</span>

                        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;FoldChange&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span>
                            <span class="n">df_stat_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;DiffExpr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Down&quot;</span>
                        
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">df_stat_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;DiffExpr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Not Diff&quot;</span>
                        
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">df_stat_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;DiffExpr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Not Diff&quot;</span>
                
                <span class="k">return</span> <span class="n">df_stat_test</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error. Groups have not been formed correctly. Check groups information, (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_group_1</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group_2</span><span class="p">()))</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error. (</span><span class="si">{}</span><span class="s2">) is not a column of clinical information&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_grouped_by</span><span class="p">()))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="GenesLenght"><a class="viewcode-back" href="../../src.html#src.processing.GenesLenght">[docs]</a><span class="k">class</span> <span class="nc">GenesLenght</span><span class="p">(</span><span class="n">GeneAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a DataFrame with the genemodel information, return all lenght of the actual studied genes</span>
<span class="sd">        </span>
<span class="sd">    :param lenght_columname: name of the column that contains information about their lenght</span>
<span class="sd">    :type lenght_columname: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenght_columname</span> <span class="o">=</span> <span class="s2">&quot;width&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lenght_columname</span> <span class="o">=</span> <span class="n">lenght_columname</span>
        
    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="GenesLenght.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.GenesLenght.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;lenght_columname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenght_columname</span>

        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="GenesLenght.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.GenesLenght.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lenght_columname</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;lenght_columname&#39;</span><span class="p">]</span> </div>

    <span class="c1"># Getter</span>

<div class="viewcode-block" id="GenesLenght.get_lenght_columname"><a class="viewcode-back" href="../../src.html#src.processing.GenesLenght.get_lenght_columname">[docs]</a>    <span class="k">def</span> <span class="nf">get_lenght_columname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns name of the column of Genemodel with lenght information</span>

<span class="sd">        :return: name of the lenght column</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenght_columname</span></div>


<div class="viewcode-block" id="GenesLenght.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.GenesLenght.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lenght_columname&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Name of the column that represents Lenght Gene on model&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;genemodel&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe that represents genecode&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame with lenghts of the genes&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="GenesLenght.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.GenesLenght.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


<div class="viewcode-block" id="GenesLenght.apply"><a class="viewcode-back" href="../../src.html#src.processing.GenesLenght.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genemodel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param genemodel: The current DataFrame to be process</span>
<span class="sd">        :type genemodel: DataFrame</span>
<span class="sd">        :return: a dataframe with lenghts of the genes</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">DataProjectionName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_lenght_columname</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">genemodel</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="GeneIDLenght"><a class="viewcode-back" href="../../src.html#src.processing.GeneIDLenght">[docs]</a><span class="k">class</span> <span class="nc">GeneIDLenght</span><span class="p">(</span><span class="n">GeneAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns lenght of a specific gen indicates</span>
<span class="sd">        </span>
<span class="sd">    :param gen_id: identifier of the gene on a genemodel</span>
<span class="sd">    :type gen_id: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gen_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen_id</span> <span class="o">=</span> <span class="n">gen_id</span>
        
    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="GeneIDLenght.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.GeneIDLenght.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;gen_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_id</span>

        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="GeneIDLenght.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.GeneIDLenght.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen_id</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;gen_id&#39;</span><span class="p">]</span> </div>

    <span class="c1"># Getter</span>

<div class="viewcode-block" id="GeneIDLenght.get_gen_id"><a class="viewcode-back" href="../../src.html#src.processing.GeneIDLenght.get_gen_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_gen_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns name of the gen to obtain lenght information</span>

<span class="sd">        :return: name of the gen</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_id</span></div>


<div class="viewcode-block" id="GeneIDLenght.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.GeneIDLenght.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;gen_id&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;Identifier of the Gene&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;genemodel&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe that represents genecode&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;lenght of the gene&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="GeneIDLenght.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.GeneIDLenght.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


<div class="viewcode-block" id="GeneIDLenght.apply"><a class="viewcode-back" href="../../src.html#src.processing.GeneIDLenght.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genemodel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. It reproduces the</span>
<span class="sd">            corresponding task of the class for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: a DataFrame with genemodel information</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: the lenght of a specific gen selected</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">DataExplainVariableColname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_gen_id</span><span class="p">(),</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">genemodel</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="RPK"><a class="viewcode-back" href="../../src.html#src.processing.RPK">[docs]</a><span class="k">class</span> <span class="nc">RPK</span><span class="p">(</span><span class="n">GeneAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Normalize values of DataFrame using RPK method</span>
<span class="sd">        </span>
<span class="sd">    :param genemodel: a DataFrame with gene information, like gene lenght</span>
<span class="sd">    :type genemodel: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genemodel</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span> <span class="o">=</span> <span class="n">genemodel</span>
        
    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="RPK.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RPK.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;genemodel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span>

        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="RPK.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RPK.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;genemodel&#39;</span><span class="p">]</span> </div>

    <span class="c1"># Getter</span>

<div class="viewcode-block" id="RPK.get_genemodel"><a class="viewcode-back" href="../../src.html#src.processing.RPK.get_genemodel">[docs]</a>    <span class="k">def</span> <span class="nf">get_genemodel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a DataFrame with genemodel information</span>

<span class="sd">        :return: Genemodel</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span></div>


<div class="viewcode-block" id="RPK.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RPK.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;genemodel&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame that contains information about Genes&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with Count Matrix (with its rows and columns)&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;RPK calculated on Count Matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="RPK.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RPK.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


<div class="viewcode-block" id="RPK.apply"><a class="viewcode-back" href="../../src.html#src.processing.RPK.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame with computed RPK</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">genes_list</span> <span class="o">=</span> <span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">count_matrix_rpk</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                        
        <span class="n">genes_lenght</span> <span class="o">=</span> <span class="n">GenesLenght</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_genemodel</span><span class="p">())</span>

        <span class="c1"># In Kilobase</span>
        <span class="n">genemodel_kilo</span> <span class="o">=</span> <span class="n">genes_lenght</span> <span class="o">/</span> <span class="mi">1000</span>

        <span class="n">rpk</span> <span class="o">=</span> <span class="n">count_matrix_rpk</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">genes_list</span><span class="p">]</span> <span class="o">/</span> <span class="n">genemodel_kilo</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">genes_list</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="k">return</span> <span class="n">rpk</span></div></div>



<div class="viewcode-block" id="TPM"><a class="viewcode-back" href="../../src.html#src.processing.TPM">[docs]</a><span class="k">class</span> <span class="nc">TPM</span><span class="p">(</span><span class="n">GeneAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Normalize values of DataFrame using TPM method</span>
<span class="sd">        </span>
<span class="sd">    :param genemodel: a DataFrame with gene information, like gene lenght</span>
<span class="sd">    :type genemodel: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genemodel</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span> <span class="o">=</span> <span class="n">genemodel</span>
        
    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="TPM.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.TPM.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;genemodel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span>

        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="TPM.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.TPM.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;genemodel&#39;</span><span class="p">]</span> </div>

    <span class="c1"># Getter</span>

<div class="viewcode-block" id="TPM.get_genemodel"><a class="viewcode-back" href="../../src.html#src.processing.TPM.get_genemodel">[docs]</a>    <span class="k">def</span> <span class="nf">get_genemodel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a DataFrame with genemodel information</span>

<span class="sd">        :return: Genemodel</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span></div>


<div class="viewcode-block" id="TPM.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.TPM.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;genemodel&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame that contains information about Genes&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with Count Matrix (with its rows and columns)&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame with count matrix normalized&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="TPM.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.TPM.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


<div class="viewcode-block" id="TPM.apply"><a class="viewcode-back" href="../../src.html#src.processing.TPM.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame with computed TPM</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        TPM NORMALIZATION</span>
<span class="sd">        Step 1 --&gt; Normalize for gene length (kilobase) =&gt; Read per Kilobase (RPK)</span>
<span class="sd">        Step 2 --&gt; Normalize for sequencing depth (divide by total RPK)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">genes_list</span> <span class="o">=</span> <span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">samples_list</span> <span class="o">=</span> <span class="n">DataColumnames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># STEP 1</span>

        <span class="c1"># RPK Calculated</span>

        <span class="n">rpk</span> <span class="o">=</span> <span class="n">RPK</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_genemodel</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># Step 2</span>

        <span class="n">tpm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">rpk_values</span> <span class="o">=</span> <span class="n">rpk</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Calculating TPM... Step 2:</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        
            <span class="n">rpk_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rpk_values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>

            <span class="n">scaled_rpk_depth</span> <span class="o">=</span> <span class="n">rpk_depth</span> <span class="o">/</span> <span class="mi">1000000</span>

            <span class="c1"># Divide by Zero avoid. Will be NaN</span>
            <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>  
                <span class="n">tpm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">rpk_values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">scaled_rpk_depth</span>

                <span class="c1"># Transform NaN to 0</span>
                <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">tpm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># Finish TPM</span>
        <span class="n">tpm_dframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tpm</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">genes_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">samples_list</span><span class="p">)</span>
        <span class="n">tpm_dframe</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>

        <span class="k">return</span> <span class="n">tpm_dframe</span></div></div>



<div class="viewcode-block" id="RPKM"><a class="viewcode-back" href="../../src.html#src.processing.RPKM">[docs]</a><span class="k">class</span> <span class="nc">RPKM</span><span class="p">(</span><span class="n">GeneAnalysis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Normalize values of DataFrame using RPKM method</span>
<span class="sd">        </span>
<span class="sd">    :param genemodel: a DataFrame with gene information, like gene lenght</span>
<span class="sd">    :type genemodel: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genemodel</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span> <span class="o">=</span> <span class="n">genemodel</span>
        
    <span class="c1"># Parameters</span>

<div class="viewcode-block" id="RPKM.get_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RPKM.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary with all parameters needed to</span>
<span class="sd">            initialize the class object to apply a Task.</span>
<span class="sd">            It allows to implement Reflection</span>

<span class="sd">        :return: a dictionary with all parameters</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;genemodel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span>

        <span class="k">return</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="RPKM.set_parameters"><a class="viewcode-back" href="../../src.html#src.processing.RPKM.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the initial parameters to specific arguments</span>
<span class="sd">            for a Task necessary for a Task to apply its functionality.</span>

<span class="sd">        :param parameters: a dictionary with specific parameters</span>
<span class="sd">        :type parameters: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;genemodel&#39;</span><span class="p">]</span> </div>

    <span class="c1"># Getter</span>

<div class="viewcode-block" id="RPKM.get_genemodel"><a class="viewcode-back" href="../../src.html#src.processing.RPKM.get_genemodel">[docs]</a>    <span class="k">def</span> <span class="nf">get_genemodel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a DataFrame with genemodel information</span>

<span class="sd">        :return: Genemodel</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">genemodel</span></div>


<div class="viewcode-block" id="RPKM.get_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RPKM.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary denoting the type of parameters the class will receive.</span>
<span class="sd">            This allows check parameters before execution and it allows </span>
<span class="sd">            the user to know the information about them.</span>

<span class="sd">        :return: a dictionary with Input Parameters information, Apply Input parameters information</span>
<span class="sd">            and the return information</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Input Parameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;genemodel&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a DataFrame that contains information about Genes&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Apply Input&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;a dataframe with Count Matrix (with its rows and columns)&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;Output&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;return&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span> <span class="p">:</span> <span class="s2">&quot;RPKM calculated on Count Matrix&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="RPKM.show_metadata"><a class="viewcode-back" href="../../src.html#src.processing.RPKM.show_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">show_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It only print on output the parameters information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">())</span></div>


<div class="viewcode-block" id="RPKM.apply"><a class="viewcode-back" href="../../src.html#src.processing.RPKM.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It is the main function of the class. </span>
<span class="sd">            It reproduces the corresponding task of the class </span>
<span class="sd">            for which it was created</span>
<span class="sd">        </span>
<span class="sd">        :param data: The current DataFrame to be process</span>
<span class="sd">        :type data: DataFrame</span>
<span class="sd">        :return: a DataFrame with computed RPKM</span>
<span class="sd">        :rtype: DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        
        <span class="n">inputs_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()[</span><span class="s2">&quot;Apply Input&quot;</span><span class="p">]</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">inputs_params</span><span class="p">)</span>
        
        <span class="n">genes_list</span> <span class="o">=</span> <span class="n">DataRownames</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">genes_lenght</span> <span class="o">=</span> <span class="n">GenesLenght</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_genemodel</span><span class="p">())</span>
        
        <span class="n">scales</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Sums the columns</span>

        <span class="c1"># Calculating Reads per million (RPM)</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DIVIDE LAS COLUMNAS DE LA MATRIZ ENTRE LOS ESCALARES CALCULADOS</span>
<span class="sd">        Es decir, el elemento[0] de sums divide a cada elemento de la columna 0, el [1] a cada elemento de la columna 1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mat_RPM</span> <span class="o">=</span> <span class="n">data</span> <span class="o">/</span> <span class="n">scales</span>

        <span class="c1"># Normalizing to gene length to get RPKM/FPKM</span>

        <span class="n">rpkm</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span><span class="n">mat_RPM</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">genes_list</span><span class="p">]</span> <span class="o">/</span> <span class="n">genes_lenght</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">genes_list</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rpkm</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Alba Casillas Rodr√≠guez.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    .wy-nav-content-wrap {
        height: 100%;
        width: 100%;
        background: hsl(0, 0%, 100%);
        display: block;
    }

    .wy-nav-content {
        height: 100%;
        width: 100%;
        background: hsl(0, 0%, 100%);
    }

    .rst-content {
        width: 100%;
        height: 100%;
    }

    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search,
    .wy-nav-top {
        background: hsl(0, 2%, 10%);
    }

    /* Sidebar */
    .wy-nav-side {
        background: #85e4a5;
    }

    .caption {
        background: hsl(0, 0%, 100%);
    }

    .caption-text {
        color: hsl(0, 0%, 0%)
    }

    .wy-menu-vertical a {
        color: hsl(0, 0%, 0%)
    }

    .wy-menu-vertical a:hover {
        color: hsl(0, 0%, 100%)
    }
</style>


</body>
</html>